[
  {
    "problem_id": "P5070",
    "source": "luogu",
    "title": "[Ynoi Easy Round 2015] 即便看不到未来",
    "description": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \n我不会再闷闷不乐了  \n那撕裂胸口的悲伤  \n还有快流下来的眼泪  \n全都是塑造出现在的我的东西  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \n烦恼  \n灰心  \n痛苦  \n喜悦  \n全部不可或缺  \n现在站在这里的不是别人  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \n毫无疑问是我自己，是珂朵莉   \n对，至少现在如此  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \n记忆慢慢地缺失  \n人格在逐渐崩坏   \n抱歉  \n你们当中   \n已经有一半的人我不记得了...   \n忘记的名字还可以重新记住  \n但是失去的记忆却无可挽回   \n这个将要崩坏的自己，还能被称作珂朵莉吗...？  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \n可即便这样的感情，我也想要毫无保留地去珍惜   \n因为如果连这种感情都失去的时候  \n我大概就会...彻底消失吧\n\n珂朵莉给了你一个序列，每次查询一段区间中长度为 $1,2,\\ldots,10$ 的极长值域连续段个数。\n定义值域连续段为：\n\n* 把区间里面所有数排序后去重，设排序后得到的序列为 $b$。\n* 如果对于二元组 $(l,r)$ 满足 $b_l,b_{l+1},\\ldots,b_r$ 中每个数为前一个数 $+1$。\n* 而且对于二元组 $(l,r+1)$，$(l-1,r)$ 均不满足，我们称 $(l,r)$ 为一个长度为 $r-l+1$ 的极长值域连续段。",
    "input": "第一行两个整数 $n,m$，表示序列的长度和查询的次数。\n\n之后一行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行每行两个整数 $l,r$ 表示查询的区间。",
    "output": "对于每次询问，输出一个长度为 $10$ 的字符串，第 $i$ 个字符表示长度为 $i$ 的极长连续段个数 $\\bmod 10$的结果。",
    "constraints": "对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq10^6$，$1\\leq l\\leq r\\leq n$。"
  },
  {
    "problem_id": "GYM104668I",
    "source": "icpc_gym",
    "title": "I. The Silence of the Lamps",
    "description": "First, for those who have never seen a lamp before, let's say it is a cuboid (box with rectangular faces) made of glass and filled with gas. All sides of a lamp have integer lengths. Once upon a time, our lecturer was sentenced for destroying lamps on a street. He must have gone somewhat crazy, as he thought some of the lamps were screaming at him in high-pitched voices.\n\nIn his beautiful mind, he followed a weird pattern. He only recognized and destroyed those lamps which had no square face and whose volume did not exceed a fixed value. Later, during a session with his doctor Clarice, he said he was very scared of large objects and of objects with too regular shapes.\n\nYour task is to count all possible shapes matching lecturer's conditions.",
    "input": "The first input line contains a number $T$ of test cases ($1 \\leq T \\leq 10^5$). Each of the next $T$ lines contains a single integer $N$ ($1 \\leq N \\leq 10^6$), the maximum recognizable volume of a lamp.",
    "output": "For each test case output the number of different lamp shapes which could have been destroyed in the rage.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "P13433",
    "source": "luogu",
    "title": "[GCJ 2009 #1A] Collecting Cards",
    "description": "You've become addicted to the latest craze in collectible card games, PokeCraft: The Gathering. You've mastered the rules! You've crafted balanced, offensive, and defensive decks! You argue the merits of various cards on Internet forums! You compete in tournaments! And now, as they just announced their huge new set of cards coming in the year 2010, you've decided you'd like to collect every last one of them! Fortunately, the one remaining sane part of your brain is wondering: how much will this cost?\n\nThere are $C$ kinds of card in the coming set. The cards are going to be sold in \"booster packs\", each of which contains $N$ cards of different kinds. There are many possible combinations for a booster pack where no card is repeated. When you pay for one pack, you will get any of the possible combinations with equal probability. You buy packs one by one, until you own all the $C$ kinds. What is the expected (average) number of booster packs you will need to buy?",
    "input": "The first line of input gives the number of cases, $T$. $T$ test cases follow, each consisting of a line containing $C$ and $N$.",
    "output": "For each test case, output one line in the form\n\nCase #$x$: $E$\n\nwhere $x$ is the case number, starting from 1, and $E$ is the expected number of booster packs you will need to buy. Any answer with a relative or absolute error at most $10^{-5}$ will be accepted.",
    "constraints": ""
  },
  {
    "problem_id": "GYM105230G",
    "source": "icpc_gym",
    "title": "G. Great Factors",
    "description": "You have an array $a$ of $n$ positive integers. There are three types of operations performed on this array:\n\nGiven the array $a$ and a sequence of $q$ operations performed in order, determine the result of each type 2 operation.",
    "input": "The first line contains an integer $n$ ($1 \\leq n \\leq 10^5$), the size of the array $a$. The second line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($1 \\leq a_i \\leq 10^4$), the elements of the array $a$. The third line contains an integer $q$ ($1 \\leq q \\leq 10^5$), the number of operations. The next $q$ lines describe the operations performed in order. Each operation is described by an integer $t$ ($1 \\leq t \\leq 3$) and the values corresponding to the operation. If $t=1$, a value $i$ ($1 \\leq i \\leq n$) is given. If $t=2$, two values $l$ and $r$ ($1 \\leq l \\leq r \\leq n$) are given. If $t=3$, three values $l$, $r$, and $x$ ($1 \\leq l \\leq r \\leq n$, $1 \\leq x \\leq 10^4$) are given.",
    "output": "For each type 2 operation, print an integer, the minimum possible sum of the prime factors of the numbers $a_l, a_{l+1}, \\ldots, a_r$.",
    "constraints": "time limit per test 1 second\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF585D",
    "source": "codeforces",
    "title": "D. Lizard Era: Beginning",
    "description": "In the game Lizard Era: Beginning the protagonist will travel with three companions: Lynn, Meliana and Worrigan. Overall the game has n mandatory quests. To perform each of them, you need to take exactly two companions.\n\nThe attitude of each of the companions to the hero is an integer. Initially, the attitude of each of them to the hero of neutral and equal to 0. As the hero completes quests, he makes actions that change the attitude of the companions, whom he took to perform this task, in positive or negative direction.\n\nTell us what companions the hero needs to choose to make their attitude equal after completing all the quests. If this can be done in several ways, choose the one in which the value of resulting attitude is greatest possible.",
    "input": "The first line contains positive integer n (1 ≤ n ≤ 25) — the number of important tasks. Next n lines contain the descriptions of the tasks — the i -th line contains three integers l i, m i, w i — the values by which the attitude of Lynn, Meliana and Worrigan respectively will change towards the hero if the hero takes them on the i -th task. All the numbers in the input are integers and do not exceed 10 7 in absolute value.",
    "output": "If there is no solution, print in the first line \" Impossible \". Otherwise, print n lines, two characters is each line — in the i -th line print the first letters of the companions' names that hero should take to complete the i -th task (' L ' for Lynn, ' M ' for Meliana, ' W ' for Worrigan). Print the letters in any order, if there are multiple solutions, print any of them.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM104090D",
    "source": "icpc_gym",
    "title": "D. Money Game",
    "description": "Putata and Budada are organizing a game with $n$ players. Each player has some deposit, which is a real number. Player $i$ has $a_i$ deposits in the beginning. During each round of the game, the followings happen in order :\n\nThe $n$ players played this game for exactly $2022^{1204}$ rounds. Putata wonders how much deposit each player has after the game. Please write a program to answer his question.",
    "input": "The first line contains an integer $n$ ($2\\leq n\\leq 10^5$), denoting the number of players. The second line contains $n$ integers $a_1,a_2,\\ldots,a_n$ ($1\\leq a_i \\leq 10^6$), denoting the deposit player $i$ has in the beginning.",
    "output": "Output one line with $n$ real numbers, denoting the deposit each player has after they played this game. Your answer will be considered correct if its absolute or relative error does not exceed $10^{-6}$. Formally, let your answer be $a$, and the jury's answer be $b$. Your answer will be considered correct if $\\frac{|a-b|}{\\max(1,|b|)}\\leq 10^{-6}$.",
    "constraints": "time limit per test 1 second\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "CF1721D",
    "source": "codeforces",
    "title": "D. Maximum AND",
    "description": "You are given two arrays $a$ and $b$, consisting of $n$ integers each.\n\nLet's define a function $f(a, b)$ as follows:\n\nFind the maximum value of the function $f(a, b)$ if you can reorder the array $b$ in an arbitrary way (leaving the initial order is also an option).",
    "input": "The first line contains one integer $t$ ($1 \\le t \\le 10^4$) — the number of test cases. The first line of each test case contains one integer $n$ ($1 \\le n \\le 10^5$) — the size of arrays $a$ and $b$. The second line contains $n$ integers $a_1, a_2, \\dots, a_n$ ($0 \\le a_i < 2^{30}$). The third line contains $n$ integers $b_1, b_2, \\dots, b_n$ ($0 \\le b_i < 2^{30}$). The sum of $n$ over all test cases does not exceed $10^5$.",
    "output": "For each test case print one integer — the maximum value of the function $f(a, b)$ if you can reorder the array $b$ in an arbitrary way.",
    "constraints": "time limit per test 3 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM104755E",
    "source": "icpc_gym",
    "title": "E. T-shirt",
    "description": "You are a fashion designer and you are excited about your fresh idea for a T-shirt. A T-shirt of size $n$ for your purposes is an $n \\times n$ grid of unit squares. Your idea is to make such a T-shirt by sewing together T-patches. A T-patch consists of $3$ near-unit length segments connecting in a single point as shown:\n\nYour design idea requires placing T-patches so that each side of each square of the T-shirt is covered by exactly one T-patch. Each T-patch can be rotated in any of the four orthogonal directions. For example, a T-shirt of size $2$ can be sewn as follows:\n\nGiven the size of the T-shirt $n$, find a correct way to sew it from T-patches or determine that it is impossible!",
    "input": "The input contains a single integer $n$ ($1 \\leq n \\leq 1\\,000$), the size of the T-shirt.",
    "output": "The first line of output should contain \" Yes \" if there exists a required T-shirt of the given size, and \" No \" otherwise. In the first case you should then output $n+1$ lines of $n+1$ characters describing the design. The $j$ -th character in the $i$ -th line describes the intersection of the $i$ -th horizontal and $j$ -th vertical grid lines. For a T-patch, denote the shortest segment as its stem. If a center of a T-patch is located at that point output \" D \", \" R \", \" U \" or \" L, if the stem points downward, rightward, upward or leftward, respectively. Otherwise, output the point character \". \". If there are multiple solutions, output any of those.",
    "constraints": "time limit per test 1 second\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF1182D",
    "source": "codeforces",
    "title": "D. Complete Mirror",
    "description": "You have given tree consist of $n$ vertices. Select a vertex as root vertex that satisfies the condition below.\n\nDetermine and find if there is such root vertex in the tree. If there are multiple answers, find any of them.",
    "input": "The first line contains a single integer $n$ ($1 \\le n \\le 10^{5}$) — the number of vertices. Each of the next $n-1$ lines contains two integers $v_{i}$ and $u_{i}$ ($1 \\le v_{i} \\lt u_{i} \\le n$) — it means there is an edge exist between $v_{i}$ and $u_{i}$. It is guaranteed that the graph forms tree.",
    "output": "If there is such root vertex exists, print any of them. Otherwise, print $-1$.",
    "constraints": "time limit per test 1 second\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "P4835",
    "source": "luogu",
    "title": "[JSOI2014] 学生选课",
    "description": "进入大学以后，学生们将面临选课，有 $n$ 个学生需要选课，学校里有三个老师 JYY，YJY，YYJ。\n\n第一年里，每个学生们都选择了其中一位老师。经过了一年的学习，学生之间相互都有一定的印象，每个同学会根据自己的印象给另外 $n-1$ 个学生从好到坏排序。第二年的选课开始了，每个学生需要选择老师，可能是因为被坑多了，每一位同学都想换一个老师。这时需要你来调度同学们选课，使得上同一堂课的学生之间印象最坏的最好。",
    "input": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 $n$ 个正整数，其中第 $i+1$ 行提供第 $i$ 个同学的信息。其中第一个整数 $A_i$，值为 $0,1,2$ 中的一个，表示第一年第 $i$ 个同学选的老师。\n接下来 $n-1$ 个数字，是 $1,2,\\cdots,i-1,i+1,\\cdots,n$ 的一个排列，表示第 $i$ 个同学对其他同学印象从好到坏的排序。",
    "output": "一行一个整数，为最小的非负整数 $T$，满足：\n\n- 所有同学选择了和第一年不同的老师。\n\n- 所有选择同一个老师的学生间彼此印象都是前 $T$ 好的。",
    "constraints": "### 数据范围\n对于 $100\\%$ 的数据，$n\\leq 1000$。"
  },
  {
    "problem_id": "P5633",
    "source": "luogu",
    "title": "最小度限制生成树",
    "description": "给你一个有 $n$ 个节点，$m$ 条边的带权无向图，你需要求得一个生成树，使边权总和最小，且满足编号为 $s$ 的节点正好连了 $k$ 条边。",
    "input": "第一行四个数：$n,m,s,k$\n\n下面的 $m$ 行，每行三个整数：$u,v,w$，表示有一条 $u$ 连向 $v$ 权值为 $w$ 的边。",
    "output": "输出一个数：满足要求的生成树的总边权。\n\n可能会出现无解的情况，如果无解，则输出 `Impossible`。",
    "constraints": "### 数据范围\n对于 $20\\%$ 的数据，$n \\le 10$，$m \\le 30$。\n对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 5000$。\n对于 $100\\%$ 的数据，$1\\leq s \\leq n \\le 5\\times 10^4$，$1\\leq m \\le 5\\times 10^5 $，$1\\leq k \\le 100$，$0\\leq w\\leq 3\\times 10^4$。\n### 注意\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。"
  },
  {
    "problem_id": "P14163",
    "source": "luogu",
    "title": "[ICPC 2022 Nanjing R] 堆里的 NaN",
    "description": "$$\\textbf{预备知识：NaN}$$\n\n$\\texttt{NaN}$ (Not a Number) 是 1985 年 IEEE 754 浮点数标准里引入的特殊浮点数。标准规定，当 $\\texttt{NaN}$ 与一个浮点数 $\\texttt{x}$ 进行比较时（$\\texttt{x}$ 可以是正数，零，负数，甚至是 $\\texttt{NaN}$ 本身），应当返回以下结果。\n\n$$\n\\begin{array}{|c|c|c|c|c|c|c|}\n\\hline\n\\textbf{比较} & \\texttt{NaN} \\ge \\texttt{x} & \\texttt{NaN} \\le \\texttt{x} & \\texttt{NaN} > \\texttt{x} & \\texttt{NaN} < \\texttt{x} & \\texttt{NaN} = \\texttt{x} & \\texttt{NaN} \\ne \\texttt{x} \\\\\n\\hline\n\\textbf{结果} & False & False & False & False & False & True \\\\\n\\hline\n\\end{array}\n$$\n\n$$\\textbf{预备知识：堆}$$\n\n堆是一种数据结构，可以用具有特殊性质的序列表示。以下算法展示了如何将 $n$ 个浮点数 $a_1, a_2, \\cdots, a_n$ 按顺序加入小根堆 $H$ 中，其中 $H$ 是一个初始为空的序列。\n\n以下算法中，用 $h_i$ 表示 $H$ 的第 $i$ 个元素，用 $j/2$ 表示满足 $2x \\le j$ 的最大整数 $x$。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/i4ewkc8v.png)\n:::\n\n$$\\textbf{问题}$$\n\n给定一个整数 $n$，考察这 $n$ 个元素的排列：从 $1$ 到 $(n - 1)$ 的所有整数（含两端），再加上一个额外的元素 $\\texttt{NaN}$。称这 $n$ 个元素的一个排列 $P$ 是“堆序列”，若存在这 $n$ 个元素的一个排列 $Q$ 满足 $P = \\text{\\texttt{HEAPIFY}}(Q)$。\n\n现在从这 $n$ 个元素的所有排列中等概率随机选取一个（也就是说，一个特定的排列被选中的概率是 $\\frac{1}{n!}$），求被选中的排列是堆序列的概率。",
    "input": "有多组测试数据。第一行输入一个整数 $T$（$1 \\le T \\le 10^3$）表示测试数据组数，对于每组测试数据：\n\n第一行输入一个整数 $n$（$1 \\le n \\le 10^9$）。",
    "output": "每组数据输出一行表示答案。\n\n可以证明答案是一个有理数 $\\frac{p}{q}$。为了避免精度问题，请输出整数 $(pq^{-1} \\bmod M)$ 作为答案，其中 $M = 10^9 + 7$，$q^{-1}$ 是满足 $qq^{-1} \\equiv 1 \\pmod M$ 的整数。",
    "constraints": "对于第二组样例数据，有 $4$ 个堆序列。\n- $\\{\\texttt{NaN}, 1, 2\\} = \\text{\\texttt{HEAPIFY}}(\\{\\texttt{NaN}, 1, 2\\})$。\n- $\\{\\texttt{NaN}, 2, 1\\} = \\text{\\texttt{HEAPIFY}}(\\{\\texttt{NaN}, 2, 1\\})$。\n- $\\{1, \\texttt{NaN}, 2\\} = \\text{\\texttt{HEAPIFY}}(\\{1, \\texttt{NaN}, 2\\}) = \\text{\\texttt{HEAPIFY}}(\\{2, \\texttt{NaN}, 1\\})$。\n- $\\{1, 2, \\texttt{NaN}\\} = \\text{\\texttt{HEAPIFY}}(\\{1, 2, \\texttt{NaN}\\}) = \\text{\\texttt{HEAPIFY}}(\\{2, 1, \\texttt{NaN}\\})$。\n所以答案用有理数表示是 $\\frac{4}{3!} = \\frac{2}{3}$。因为 $3 \\times 333333336 \\equiv 1 \\pmod M$，我们应该输出 $2 \\times 333333336 \\bmod M = 666666672$。"
  },
  {
    "problem_id": "P1753",
    "source": "luogu",
    "title": "矩阵链排序问题",
    "description": "给定 $n$ 个矩阵，已知第 $i$ 个矩阵 $M_i$ 的大小为 $w_i$ 行 $w_{i+1}$ 列，而我们并不关心其内容。我们考虑将其按照顺序相乘（称其为链乘积）：\n\n$$ M = M_1 \\times M_2 \\times \\cdots \\times M_n $$\n\n矩阵乘法并不满足交换律，但是其满足结合律，因此我们可以通过合理安排结合顺序，尽可能减少需要的运算次数。在此题中，我们定义将一个大小为 $a \\times b$ 的矩阵乘以一个大小为 $b \\times c$ 的矩阵需要 $abc$ 次运算。\n\n请你算出将题目所给的 $n$ 个矩阵进行链乘积所需的最少运算数。为了方便起见，你不需要构造方案。",
    "input": "输入的第一行为一个正整数 $n$，代表矩阵的数量。\n\n接下来的一行包含 $n+1$ 个正整数，其中第 $i$ 个整数为 $w_i$，含义参考题目描述。",
    "output": "输出包含一个整数，代表最小运算次数。",
    "constraints": "样例解释：样例告诉我们有 $n = 3$ 个矩阵，其大小分别是 $5 \\times 3$，$3 \\times 2$ 和 $2 \\times 6$。分别考虑两种乘法顺序：\n- 先将 $M_1$ 和 $M_2$ 相乘得到一个 $5 \\times 2$ 的矩阵，然后和 $M_3$ 相乘，此时运算次数为 $5 \\times 3 \\times 2 + 5 \\times 2 \\times 6 = 90$；\n- 先将 $M_2$ 和 $M_3$ 相乘得到一个 $3 \\times 6$ 的矩阵，然后和 $M_1$ 相乘，此时运算次数为 $3 \\times 2 \\times 6 + 5 \\times 3 \\times 6 = 126$。"
  },
  {
    "problem_id": "CF460E",
    "source": "codeforces",
    "title": "E. Roland and Rose",
    "description": "Roland loves growing flowers. He has recently grown a beautiful rose at point (0, 0) of the Cartesian coordinate system. The rose is so beautiful that Roland is afraid that the evil forces can try and steal it.\n\nTo protect the rose, Roland wants to build n watch towers. Let's assume that a tower is a point on the plane at the distance of at most r from the rose. Besides, Roland assumes that the towers should be built at points with integer coordinates and the sum of squares of distances between all pairs of towers must be as large as possible. Note, that Roland may build several towers at the same point, also he may build some of them at point (0, 0).\n\nHelp Roland build the towers at the integer points so that the sum of squares of distances between all towers is maximum possible. Note that the distance in this problem is defined as the Euclidian distance between points.",
    "input": "The first line contains two integers, n and r (2 ≤ n ≤ 8; 1 ≤ r ≤ 30).",
    "output": "In the first line print an integer — the maximum possible sum of squared distances. In the i -th of the following n lines print two integers, x i, y i — the coordinates of the i -th tower. Each tower must be inside or on the border of the circle with radius r. Note that there may be several towers located at the same point of the plane, also some towers can be located at point (0, 0). If there are multiple valid optimal arrangements, choose any of them.",
    "constraints": "time limit per test 3 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM105139F",
    "source": "icpc_gym",
    "title": "F. Enchanted",
    "description": "In Minecraft, one way to become stronger is to have the armors and weapons enchanted. Enchanted books play an important role.\n\nThe most important attribute of an enchanted book is its level. The higher the level is, the better the book is. We could merge two books with the same level $l$ into one new book(the older two will disappear). The level of the new book is $l+1$ and the merger costs $2^{l+1}$.\n\nNow, Steve has $n$ enchanted books numbered from $1$ to $n$. Initially, the $i$ -th book's level is $a_i$. Steve asks you to help him with the following four operations.\n\nStep $1$ : Steve merges all the books numbered from $l$ to $r$ until there does not exist two books with the same level.\n\nStep $2$ : Steve adds one new book with level $k$ to the books he gets in Step $1$.\n\nStep $3$ : Steve needs to merge books he gets in Step $2$ and he wants to maximize the times he merges the books.\n\nPlease calculate and output the total cost modulo $10^9+7$ in Step $3$.\n\nNote that, after calculating, the sequence is restored. That is, this operation does NOT actually change the sequence.",
    "input": "The first and the only line contains 5 integers $n,m,A,p,q$.($1 \\leq n \\leq 10^6$, $1 \\leq m \\leq 10^6$, $1 \\leq A \\leq 19\\,260\\,817$, $1 \\leq p \\leq 4$, $1 \\leq q \\leq 30$) Please pay attention! To avoid large input file, the true input is constructed through the following strategy: Function rnd(): $A \\leftarrow (7A+13) \\bmod 19\\,260\\,817$ return A Firstly, $n$ integers $a_1,a_2,\\cdots,a_n$ are generated in turn, $a_i \\leftarrow rnd() \\bmod q + 1$. Then, the parameters of all operations are generated. For each operation, the number of operation(representing by $opt$) is firstly generated, $opt \\leftarrow rnd() \\bmod p + 1$. According to the number of operation, the different method is applied to generate parameters for different operation. For operation 1: we need to get $l$ and $r$ by using: $L \\leftarrow rnd() \\bmod n + 1$ $R \\leftarrow rnd() \\bmod n + 1$ $l \\leftarrow \\min(L,R)$ $r \\leftarrow \\max(L,R)$ For operation 2: we need to get $l,r$ and $k$ by using: $L \\leftarrow rnd() \\bmod n + 1$ $R \\leftarrow rnd() \\bmod n + 1$ $l \\leftarrow \\min(L,R)$ $r \\leftarrow \\max(L,R)$ $k \\leftarrow rnd() \\bmod q + 1$ For operation 3: we need to get $pos$ and $k$ by using: $pos \\leftarrow rnd() \\bmod n + 1$ $k \\leftarrow rnd() \\bmod q + 1$ For operation 4: we need to get $t$ by using: $t \\leftarrow rnd() \\bmod i$ Here, $i$ represents the $i$ -th operation.",
    "output": "For each operation 1 and 2, you need to output one single line with an integer, representing the answer to operation 1 and 2 modulo $10^9 + 7$.",
    "constraints": "time limit per test 1.5 s\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "P10004",
    "source": "luogu",
    "title": "[集训队互测 2023] Permutation Counting 2",
    "description": "给定 $n$，对于每组 $x,y\\in [0,n)$ 求出有多少个 $1\\sim n$ 的排列 $p$ 满足以下条件：\n\n- $\\sum\\limits_{i=1}^{n-1}[p_i<p_{i+1}]=x$。\n\n- $\\sum\\limits_{i=1}^{n-1}[p^{-1}_i<p^{-1}_{i+1}]=y$。\n\n其中 $p^{-1}$ 表示 $p$ 的逆排列，满足 $p^{-1}_{p_i}=i$。\n\n答案对给定的质数 $MOD$ 取模。",
    "input": "共一行，两个整数，表示 $n,MOD$。",
    "output": "共 $n$ 行，每行共 $n$ 个整数，第 $i$ 行第 $j$ 列的数表示 $x=i-1,y=j-1$ 时的答案。",
    "constraints": "对于 $100\\%$ 数据，$1\\le n\\le 500$，$10^9\\le MOD\\le 1.01\\times 10^9$，保证 $MOD$ 为质数。\n$\\operatorname{Subtask} 1(10\\%):n\\le 8$。\n$\\operatorname{Subtask} 2(15\\%):n\\le 16$。\n$\\operatorname{Subtask} 3(25\\%):n\\le 40$。\n$\\operatorname{Subtask} 4(25\\%):n\\le 100$。\n$\\operatorname{Subtask} 5(25\\%):$ 无特殊限制。"
  },
  {
    "problem_id": "P6774",
    "source": "luogu",
    "title": "[NOI2020] 时代的眼泪",
    "description": "小 L 喜欢与智者交流讨论，而智者也经常为小 L 出些思考题。\n\n这天智者又为小 L 构思了一个问题。智者首先将时空抽象为了一个二维平面，进而将一个事件抽象为该平面上的一个点，将一个时代抽象为该平面上的一个矩形。\n\n为了方便，下面记 $(a, b) \\leq (c, d)$ 表示平面上两个点 $(a, b),(c, d)$ 满足 $a \\leq c$，$b \\leq d$。\n\n更具体地，智者给定了 $n$ 个**事件**，他们用平面上 $n$ 个不同的点 $\\{(x_i, y_i)\\}^n_{i=1}$ 来表示；智者还给定了 $m$ 个**时代**，每个时代用平面上一个矩形 $(r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2})$ 来表示，其中 $(r_{i,1}, c_{i,1})$ 是矩形的左下角，$(r_{i,2}, c_{i,2})$ 是矩形的右上角，保证 $(r_{i,1}, c_{i,1}) \\leq (r_{i,2}, c_{i,2})$。我们称时代 $i$ 包含了事件 $j$ 当且仅当 $(r_{i,1}, c_{i,1}) \\leq (x_j, y_j ) \\leq (r_{i,2}, c_{i,2})$。\n\n智者认为若两个事件 $i, j$ 满足 $(x_i, y_i) \\leq (x_j, y_j)$，则这两个事件形成了一次**遗憾**。而对一个时代内包含的所有事件，它们所形成的遗憾被称为这个**时代的眼泪**，而形成的遗憾次数则称为该时代的眼泪的大小。现在智者想要小 L 计算**每个时代的眼泪的大小**。\n\n小 L 明白，如果他回答不了这个问题，他也将成为时代的眼泪，请你帮帮他。",
    "input": "从标准输入中读入数据。\n\n第一行两个整数 $n, m$，分别表示事件数与时代数。\n\n第二行 $n$ 个整数 $p_i$，其中第 $i$ 个数表示事件 $i$ 在平面上的坐标为 $(i, p_i)$。保证 $p_i$ 为一个 $1$ 到 $n$ 的排列。\n\n之后 $m$ 行，每行四个整数 $r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2}$，表示每个时代对应的矩形。",
    "output": "输出到文件标准输出中。\n\n输出 $m$ 行，每行包含一个整数，第 $i$ 行输出第 $i$ 个时代的眼泪的大小。",
    "constraints": "对于时代 $1$，包含的遗憾有 $(6, 7)$（即事件 $6$ 与事件 $7$ 形成的遗憾，下同）。\n对于时代 $2$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n对于时代 $3$，包含的遗憾有 $(5, 6),(5, 8)$。\n对于时代 $4$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n对于时代 $5$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n对于时代 $6$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n对于时代 $7, 8, 9$，它们均不包含任何遗憾。\n#### 样例 2\n见选手目录下的 tears/tears2.in 与 tears/tears2.ans。\n该样例满足特殊限制 A（具体限制见测试点约束）。\n#### 样例 3\n见选手目录下的 tears/tears3.in 与 tears/tears3.ans。\n该样例满足特殊限制 B（具体限制见测试点约束）。\n对于所有测试点：$1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 2 \\times 10^5$，$1 \\leq r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2} \\leq n$。\n---\n### 测试点约束\n每个测试点的具体限制见下表：\n| 测试点编号 |  $n\\le $ |  $m\\le $ | 特殊限制 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 3$ |  $10$ |  $10$ | 无 |\n|  $4$ |  $3\\times 10^3$ |  $3\\times 10^3$ | 无 |\n|  $5$ |  $4\\times 10^3$ |  $4\\times 10^3$ | 无 |\n|  $6$ |  $5\\times 10^3$ |  $5\\times 10^3$ | 无 |\n|  $7$ |  $2.5\\times 10^4$ |  $5\\times 10^4$ |  $\\text{A}$ |\n|  $8$ |  $5\\times 10^4$ |  $10^5$ |  $\\text{A}$ |\n|  $9$ |  $7.5\\times 10^4$ |  $1.5\\times 10^5$ |  $\\text{A}$ |\n|  $10$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{A}$ |\n|  $11$ |  $6\\times 10^4$ |  $1.2\\times 10^5$ |  $\\text{B}$ |\n|  $12$ |  $8\\times 10^4$ |  $1.6\\times 10^5$ |  $\\text{B}$ |\n|  $13$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{B}$ |\n|  $14$ |  $2\\times 10^4$ |  $4\\times 10^4$ | 无 |\n|  $15$ |  $3\\times 10^4$ |  $6\\times 10^4$ | 无 |\n|  $16$ |  $4\\times 10^4$ |  $8\\times 10^4$ | 无 |\n|  $17$ |  $5\\times 10^4$ |  $10^5$ | 无 |\n|  $18$ |  $6\\times 10^4$ |  $1.2\\times 10^5$ | 无 |\n|  $19$ |  $7\\times 10^4$ |  $1.4\\times 10^5$ | 无 |\n|  $20\\sim 22$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{C}$ |\n|  $23\\sim 25$ |  $10^5$ |  $2\\times 10^5$ | 无 |\n特殊限制 A：对于所有时代 $i$ 有 $c_{i,1} = 1, c_{i,2} = n$。\n特殊限制 B：任意两个不同时代所代表的矩形，它们要么是包含关系（一个矩形在另一个矩形内，边界允许重合），要么是相离关系（两矩形不包含共同点，边界不允许重合）。\n特殊限制 C：最多有 $50$ 对事件 $(i, j)(1 \\leq i < j \\leq n)$ 不满足 $(i, p_i) \\leq (j, p_j)$。"
  },
  {
    "problem_id": "P3339",
    "source": "luogu",
    "title": "[ZJOI2014] 取石子游戏",
    "description": "Roland. p Sprague 和 Patrick M. Grundy 都是组合游戏的狂热爱好者，但他们素未谋面。\n\n一天，Sprague 在写给 Grundy 的信中向他介绍了一个据称是来自东方的古老游戏一一取石子。\n\n取石子是一个双人博弈游戏。在游戏的一开始，桌面上有几堆石子堆。接下 来，游戏双方轮流进行操作：从桌面上选取一堆石子堆，然后从这一堆里面取走任意多个石子（但不能不取）。当某个人无法操作时则失败，另一方获得胜利。由于条件所限, Sprague 建议在纸上写一排自然数来代表各个石子堆的石子数目，然后两人轮流划数与数；Grundy 欣然应允。\n\n一个月过去了，在 Grundy 连续输了 $5$ 盘游戏之后，他怀疑 Sprague 要诈。经过几天的研究，Grundy 在某天下午发现假设游戏双方都足够聪明，那么给定一个初始状态（一排自然数），可以有很简单的方法来判定先手必胜还是后手必胜，并且可以给出必胜策略！于是 Grundy 决定要进行反击。\n\n翌日，Grundy 在写给 Sprague 的信中建议把游戏的规则改得更复杂一点：首先确定一个常数 $K$。然后，游戏双方的操作改为：每次选择一个数划掉。假设该数为 $x$，操作者可以任选一个正整数a，在划掉之后需要再写上 $x-a$，$x-2a $，$\\cdots$，$x-K \\times a$ 共 $K$ 个数，且 $a$ 需满足 $x-K\\times a \\geq 0$。若这样的 $a$ 不存在，那么操作者就不能划掉这个无。某一方失败的条件依然是他无法操作。\n\n碍于面子，Sprague 当然无法拒绝。不过他也不会坐以待毙，现在他已经得到了和写在纸上的个数。他把这些数据和这个游戏的规则都告诉了你一一一个正在研究如何使用一个尚不存在的机械（你将其命名为计算机）解决实际的数学、物理、经济学）的计算机科学家。",
    "input": "输入文件，第一行是一个正整数，表示数据组数 $T$（Sprague 向你询问的次数）。接下来依次输入 $T$ 组数据，每组数据占 $N + 2$ 行，格式如下：\n\n- 第 $1$ 行是一个空行。\n- 第 $2$ 行，两个正整数，按顺序表示 $N$ 和 $K$。\n- 接下来 $N$ 行，每行一个正整数，表示写在纸上的 $N$ 个数。",
    "output": "输出文件共有 $T$ 行。对每组数据，如果先手必胜（先进行操作的玩家拥有必胜策略），则输出 `Preempt.`。若后手必胜，则输出 `Leapfrog.`。若两者皆非，则输出 `Je suis un imbecile.`",
    "constraints": "$10\\%$ 的数据满足：$N \\leq 5$，$K=1$，所有数均小等于 $5$。\n$20\\%$ 的数据满足：$N \\leq 100$，$K=1$，所有数均小等于 $10^9$。\n$10\\%$ 的数据满足：$N \\leq 100$，$K=2$，所有数均小等于 $10^9$。\n$20\\%$ 的数据满足：$N \\leq 100$，$K=2$，所有数均小等于 $10^{18}$。\n$20\\%$ 的数据满足：$N \\leq 100$，$K=10$，所有数均小等于 $10^{18}$。\n$40\\%$ 的数据满足：$N \\leq 100$，$K=30$，所有数均小等于 $10^{80}$。"
  },
  {
    "problem_id": "GYM105431F",
    "source": "icpc_gym",
    "title": "F. Fence Fee",
    "description": "The National Crop Protection Commission (NCPC) is dedicated to supporting local farmers by offering subsidies that are proportional to the area of their crop fields. Each farmer can have several crop fields, each uniquely shaped but geometrically defined as a polygon, bounded by fences that meet only at the corners.\n\nIn a classic display of political bureaucracy, and to incentivize well-shaped fields, the NCPC will subsidize each crop field based on the square of its area. This, to reward well-encapsulated fields. They now require a tool that calculates the sum of the squared areas of these polygons to ensure that the subsidies are distributed fairly.",
    "input": "The first line contains an integer $F$ ($3 \\leq F \\leq 1000$), the number of fence line segments. The next $F$ lines contain four integers each, $x_1$, $y_1$, $x_2$, $y_2$ ($0 \\leq x_1, y_1, x_2, y_2 \\leq 1000$), representing a straight-line fence section. No two fence line segments intersect. Since fencing is both expensive and tedious, you may assume that every fence line segment is necessary and serves to bound fields. All fences farmers have are connected. In other words, the graph that consists of endpoints and fences is planar, connected, and has no bridges.",
    "output": "Output a single line representing the sum of the squared areas of all the fields formed by the given fence sections. Your answer will be correct if it has an absolute or relative error of at most $10^{-6}$.",
    "constraints": "time limit per test 1 second\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "P9434",
    "source": "luogu",
    "title": "[NAPC-#1] Stage4 - Needle",
    "description": "> ![](https://cdn.luogu.com.cn/upload/image_hosting/jiio1vp7.png)\n>\n> — s10\n\n平面上有 $n$ 个**位置互不相同**的刺。刺有上下左右这 $4$ 种朝向。\n\n定义一个【阴间刺】（其实就是削过的 sf 刺）为满足以下条件的有序刺**对** $(s_1,s_2,s_3)$：\n- $s_1$ 朝右，$s_2$ 朝左，$s_3$ 朝上。\n- $x(s_1)<x(s_2)\\leqslant x(s_3)$。\n- $y(s_2)>y(s_1)>y(s_3)$。\n- $x(s_2)-x(s_1)\\leqslant d$。\n\n其中 $x(s)$ 和 $y(s)$ 分别表示刺 $s$ 的横坐标和纵坐标；$d$ 为 kid 的宽度，在单组测试点中为常量。\n\n坐标系 $x$ 轴正方向为从左到右，$y$ 轴正方向为从下到上。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tzih4wjx.png) ![](https://cdn.luogu.com.cn/upload/image_hosting/4wr5yfhz.png)\n\n上图是 $d\\geqslant 2$ 时两个阴间刺的例子。~~虽然第二个刺型中 s3 对 kid 的跳跃没有影响/oh~~\n\n给出 $n$ 个刺的位置和朝向，请你告诉 kid 有多少（他跳不过去的）阴间刺。\n\n显然朝下的刺在本题内是没有意义的。",
    "input": "**本题单测试点内有多组数据。**\n\n第一行仅两个正整数 $T,id$ 表示测试数据的数量和测试点编号。特别地，样例的 $id=0$。\n\n对于每组测试点，第一行输入两个正整数 $n,d$，表示刺的数量和 kid 的宽度，接下来 $n$ 行每行两个整数 $x,y$ 和一个字符 $c$ 表示一个刺的位置和朝向：`U` 代表朝上，`D` 代表朝下，`L` 代表朝左，`R` 代表朝右。",
    "output": "对于每组测试点，输出一行一个正整数表示阴间刺的数量。",
    "constraints": "### 【数据范围】\n**本题采用捆绑测试。**\n$$\n\\def\\r{\\cr\\hline}\n\\def\\arraystretch{1.5}\n\\begin{array}{c|c|c|c|c}\n\\textbf{Subtask} & id= & {\\sum n\\leqslant} & \\textbf{Other Constraints} & \\textbf{Score}\\r\n\\textsf1 & 1\\sim 7 & 3\\times10^4 & n\\leqslant 30 & 10 \\r\n\\textsf2 & 31\\sim45 & 10^4 & - & 25 \\r\n\\textsf3 & 8\\sim10,16\\sim17 & 10^5 & d=10^9 & 20 \\r\n\\textsf4 & 18\\sim20 & 3\\times10^5 & d=1 & 10 \\r\n\\textsf5 & 11\\sim15,21\\sim30 & 3\\times10^5 & - & 35 \\r\n\\end{array}\n$$\n其中 $\\sum n$ 表示单测试点内所有 $n$ 的总和。\n对于 $100\\%$ 的数据，$1\\leqslant T\\leqslant 2\\times10^3$，$1\\leqslant n\\leqslant 3\\times10^5$，$\\sum n\\leqslant 3\\times10^5$，$1\\leqslant d\\leqslant 10^9$，$1\\leqslant x,y\\leqslant 10^9$，$(x,y)$ 互不相同，$c\\in\\{\\texttt U, \\texttt D, \\texttt L, \\texttt R \\}$。\n#### 【提示】\n$\\textbf{Sub}{\\textsf2}$ 的 $O(n^2\\log n)$ 做法和 $O(n^2)$ 做法都可以想想，可能都有些提示性……？qwq\n### 【样例 #1-1 & #1-2 解释】\n见【题目描述】中**两**幅图。\n注意 #1-2 中 $d=1$，所以 kid 可以简单地钻缝过去，不算阴间。\n### 【样例 #1-3 解释】\n![](https://cdn.luogu.com.cn/upload/image_hosting/ha8w6ljz.png)\n$4$ 个阴间刺分别为：$\\Big((1,3),(2,4),(2,1)\\Big),\\Big((1,2),(2,4),(2,1)\\Big),\\Big((1,2),(2,3),(2,1)\\Big),\\Big((1,3),(2,4),(3,2)\\Big)$\n即 $(5,6,1),(2,6,1),(2,4,1),(5,6,3)$（数字代表刺的下标：$i$ 代表第 $i$ 个刺）。\n### 【样例 #1-4 解释】\n![](https://cdn.luogu.com.cn/upload/image_hosting/q988yxmg.png)\n$6$ 个阴间刺分别为 $(2,1,7),(4,1,7),(4,3,6),(4,3,7),(4,3,8),(5,3,8)$。\n【样例 #2】见附件，该样例除 $id=0$ 外满足 $\\text{Subtask }\\textsf1$ 的所有限制。"
  },
  {
    "problem_id": "CF435E",
    "source": "codeforces",
    "title": "E. Special Graph",
    "description": "In this problem you will need to deal with an n × m grid graph. The graph's vertices are the nodes of the n × m grid. The graph's edges are all the sides and diagonals of the grid's unit squares.\n\nThe figure below shows a 3 × 5 graph. The black lines are the graph's edges, the colored circles are the graph's vertices. The vertices of the graph are painted on the picture for a reason: the coloring is a correct vertex coloring of the 3 × 5 graph into four colors. A graph coloring is correct if and only if each vertex is painted and no two vertices connected by an edge are painted the same color.\n\nYou are given the size of the grid graph n × m and the colors of some of its vertices. Find any way how to paint the unpainted vertices of the graph in 4 colors to make the final coloring a correct vertex graph coloring. If there is no such correct vertex coloring, say that the answer doesn't exist.",
    "input": "The first line contains two integers n and m (2 ≤ n, m ≤ 1000). Each of the next n lines consists of m characters — the given graph. Each character is either « 0 », « 1 », « 2 », « 3 », « 4 ». Character « 0 » means that the corresponding vertex is unpainted, otherwise the character means the color of the vertex. Assume that all the available colors are numbered from 1 to 4.",
    "output": "If there is no way to get correct vertex coloring of the graph, print 0 in a single line. Otherwise print the colored n × m graph. Print the graph in the same format as in the input. If multiple answers exist, print any of them.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF1316D",
    "source": "codeforces",
    "title": "D. Nash Matrix",
    "description": "Nash designed an interesting yet simple board game where a player is simply required to follow instructions written on the cell where the player currently stands.\n\nThis board game is played on the $n\\times n$ board. Rows and columns of this board are numbered from $1$ to $n$. The cell on the intersection of the $r$-th row and $c$-th column is denoted by $(r, c)$.\n\nSome cells on the board are called blocked zones. On each cell of the board, there is written one of the following $5$ characters  — $U$, $D$, $L$, $R$ or $X$  — instructions for the player. Suppose that the current cell is $(r, c)$. If the character is $R$, the player should move to the right cell $(r, c+1)$, for $L$ the player should move to the left cell $(r, c-1)$, for $U$ the player should move to the top cell $(r-1, c)$, for $D$ the player should move to the bottom cell $(r+1, c)$. Finally, if the character in the cell is $X$, then this cell is the blocked zone. The player should remain in this cell (the game for him isn't very interesting from now on).\n\nIt is guaranteed that the characters are written in a way that the player will never have to step outside of the board, no matter at which cell he starts.\n\nAs a player starts from a cell, he moves according to the character in the current cell. The player keeps moving until he lands in a blocked zone. It is also possible that the player will keep moving infinitely long.\n\nFor every of the $n^2$ cells of the board Alice, your friend, wants to know, how will the game go, if the player starts in this cell. For each starting cell of the board, she writes down the cell that the player stops at, or that the player never stops at all. She gives you the information she has written: for each cell $(r, c)$ she wrote:\n\nIt might be possible that Alice is trying to fool you and there's no possible grid that satisfies all the constraints Alice gave you. For the given information Alice provided you, you are required to decipher a possible board, or to determine that such a board doesn't exist. If there exist several different boards that satisfy the provided information, you can find any of them.",
    "input": "The first line of the input contains a single integer $n$ ($1 \\leq n \\leq 10^{3}$)  — the side of the board. The $i$-th of the next $n$ lines of the input contains $2n$ integers $x_1, y_1, x_2, y_2, \\dots, x_n, y_n$, where $(x_j, y_j)$ ($1 \\leq x_j \\leq n, 1 \\leq y_j \\leq n$, or $(x_j,y_j)=(-1,-1)$) is the pair written by Alice for the cell $(i, j)$.",
    "output": "If there doesn't exist a board satisfying the information that Alice gave you, print a single line containing INVALID. Otherwise, in the first line print VALID. In the $i$-th of the next $n$ lines, print the string of $n$ characters, corresponding to the characters in the $i$-th row of the suitable board you found. Each character of a string can either be $U$, $D$, $L$, $R$ or $X$. If there exist several different boards that satisfy the provided information, you can find any of them.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF25E",
    "source": "codeforces",
    "title": "E. Test",
    "description": "Sometimes it is hard to prepare tests for programming problems. Now Bob is preparing tests to new problem about strings — input data to his problem is one string. Bob has 3 wrong solutions to this problem. The first gives the wrong answer if the input data contains the substring s 1, the second enters an infinite loop if the input data contains the substring s 2, and the third requires too much memory if the input data contains the substring s 3. Bob wants these solutions to fail single test. What is the minimal length of test, which couldn't be passed by all three Bob's solutions?",
    "input": "There are exactly 3 lines in the input data. The i -th line contains string s i. All the strings are non-empty, consists of lowercase Latin letters, the length of each string doesn't exceed 10 5.",
    "output": "Output one number — what is minimal length of the string, containing s 1, s 2 and s 3 as substrings.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM104619F",
    "source": "icpc_gym",
    "title": "F. Finding Bridges",
    "description": "An undirected graph is a fundamental concept in graph theory, a branch of mathematics and computer science. It is a data structure that represents a set of vertices connected by edges that have no direction. In other words, in an undirected graph, if there is an edge from vertex $u$ to vertex $v$, there is also an edge from vertex $v$ to vertex $u$. We use a two-element set $\\{A,B\\}$ to represent such undirected edge. An undirected graph is simple if there is at most one edge between any pair of vertices.\n\nIn graph theory, a connected component is a group of vertices and edges within a graph where you can travel from any vertex to any other vertex by following a sequence of edges. A bridge is an edge in an undirected graph that, if removed, increases the number of connected components in the graph.\n\nBridges are essential concepts in graph analysis and have practical applications in network design, fault tolerance, and connectivity analysis. They are often used to identify vulnerable points in a network where the removal of a single edge could lead to the isolation of certain components or the disruption of connectivity. Identifying bridges in a graph can be done using various algorithms which can detect these crucial edges and help analyze the robustness and structure of a network or system.\n\nYou have a simple undirected graph whose vertices and edges are $V=\\{1,2,\\dots,n\\}$ and $E=\\{\\{u_1,v_1\\},\\dots,\\{u_m,v_m\\}\\}$. Your friend, Flora, ask you to sequentially remove edges $e_1,e_2,\\dots,e_q$ from your graph and report the number of bridges left in the graph after each removal. Please write a program to generate the report.",
    "input": "The first line contains three space-separated non-negative integers $n$, $m$ and $q$. $n$ is the number of vertices of the graph. $m$ is the number of edges of the graph. $q$ is the number of edges to be removed. The $i$ -th of the following $m$ lines contains two space-separated positive integers, $u_i$ and $v_i$, indicating the $i$ -th element of $E$. Then $q$ lines follows. The $j$ -th of them contains two space-separated positive integers, $x_j$ and $y_j$, indicating the $j$ -th removed edge $e_j$ is $\\{x_j,y_j\\}$. $1< n\\le 200000$ $1\\le m \\le \\min\\left(200000,{n \\choose 2}\\right)$ $1\\le q \\le m$ There are two ways to represent an edge $\\{u, v\\}$ : \" $u~v$ \" and \" $v~u$ \". $\\{x_i,y_i\\}$ must be an edge in $E$. No edge will be removed twice.",
    "output": "Output $q$ lines. The $k$ -th line should contain an integer $b_k$ indicating the number of bridges in the graph after removing $k$ edges.",
    "constraints": "time limit per test 3 seconds\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "GYM103411K",
    "source": "icpc_gym",
    "title": "K. Shark Attack",
    "description": "Одним осенним вечером $n$ кальмарам из одномерного мира стала известна печальная новость: к их месту обитания приближается акула!\n\nАкула и кальмары могут двигаться со скоростью 1 метр в секунду. При этом кальмары имеют единое сознание, поэтому в каждый момент времени двигается максимум один кальмар. Если в какой-либо момент времени акула и кальмар находятся в одной и той же позиции (их размерами можно пренебречь), то акула съедает кальмара.\n\nКонечно же, у кальмаров есть убежище, в которое вместится любое количество кальмаров, а акула не пройдет. Таким образом, если кальмар добирается до своего убежища, и над ним не находится акула, то он спасается и ему больше ничего не угрожает.\n\nВы, как воплощение коллективного сознания кальмаров, хотите спасти как можно больше представителей кальмарного «социума». Каждую секунду Вы можете отдавать приказ движения одному из кальмаров.\n\nКакое максимальное количество кальмаров Вы сможете гарантированно спасти, вне зависимости от действий акулы?",
    "input": "В первой строчке находится единственное число $n$ ($1 \\leq n \\leq 10^5$) — количество кальмаров. Во второй строчке находится $n$ целых чисел $x_1, x_2, \\dots, x_n$ ($|x_i| \\leq 10^9$) — координаты кальмаров в одномерном мире в метрах. В третьей строчке находится единственное целое число $y$ ($|y| \\leq 10^9$) — координата акулы в метрах. В последней строчке находится единственное целое число $z$ ($|z| \\leq 10^9$) — координата убежища кальмаров в метрах. Гарантируется, что ни один кальмар не находится у выхода или с акулой в начале событий.",
    "output": "Выведите единственное число — максимальное количество кальмаров, которое Вы сможете гарантированно спасти.",
    "constraints": "ограничение по времени на тест 1 секунда\nограничение по памяти на тест 256 мегабайт"
  },
  {
    "problem_id": "GYM105484C",
    "source": "icpc_gym",
    "title": "C. Topology",
    "description": "You are given a tree consisting of $n$ vertices, rooted at vertex $1$. It is guaranteed that every vertex has a smaller index than all of its children. A topological order of this tree is a permutation $p_1,p_2,\\dots,p_n$ of $n$ that satisfies the following constraint: For all $1\\leq i \\lt j\\leq n$, vertex $p_j$ is not the parent of vertex $p_i$.\n\nFor each $1 \\le i \\le n$, calculate the number of topological orders of the given tree satisfying $p_i=i$, modulo $998\\,244\\,353$.",
    "input": "There is only one test case in each test file. The first line contains an integer $n$ ($2\\leq n\\leq 5\\,000$), denoting the number of vertices of the tree. The second line contains $(n-1)$ integers $f_2,f_3,\\dots,f_n$ ($1\\leq f_i \\lt i$), where $f_i$ is the parent of vertex $i$.",
    "output": "Output one line containing $n$ integers $a_1, a_2, \\cdots, a_n$ separated by a space, where $a_i$ is the number of topological orders satisfying $p_i=i$, modulo $998\\,244\\,353$.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "CF1265E",
    "source": "codeforces",
    "title": "E. Beautiful Mirrors",
    "description": "Creatnx has $n$ mirrors, numbered from $1$ to $n$. Every day, Creatnx asks exactly one mirror \"Am I beautiful?\". The $i$ -th mirror will tell Creatnx that he is beautiful with probability $\\frac{p_i}{100}$ for all $1 \\le i \\le n$.\n\nCreatnx asks the mirrors one by one, starting from the $1$ -st mirror. Every day, if he asks $i$ -th mirror, there are two possibilities:\n\nYou need to calculate the expected number of days until Creatnx becomes happy.\n\nThis number should be found by modulo $998244353$. Formally, let $M = 998244353$. It can be shown that the answer can be expressed as an irreducible fraction $\\frac{p}{q}$, where $p$ and $q$ are integers and $q \\not \\equiv 0 \\pmod{M}$. Output the integer equal to $p \\cdot q^{-1} \\bmod M$. In other words, output such an integer $x$ that $0 \\le x \\lt M$ and $x \\cdot q \\equiv p \\pmod{M}$.",
    "input": "The first line contains one integer $n$ ($1\\le n\\le 2\\cdot 10^5$) — the number of mirrors. The second line contains $n$ integers $p_1, p_2, \\ldots, p_n$ ($1 \\leq p_i \\leq 100$).",
    "output": "Print the answer modulo $998244353$ in a single line.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM104460K",
    "source": "icpc_gym",
    "title": "K. Escape Plan",
    "description": "BaoBao, one of the most famous monster hunters, wakes up in the middle of Heltion City dominated by monsters. Having troubles remembering what has happened, BaoBao decides to escape from this horrible city as soon as possible. Despite arming no weapon, he luckily puts his hand on a map in his right pocket, which contains valuable information that can possibly help him find a way out.\n\nAccording to the map, Heltion City is composed of $n$ spots connected by $m$ undirected paths. Starting from spot $1$, BaoBao must head towards any of the $k$ exits of the city to escape, where the $i$ -th of them is located at spot $e_i$.\n\nHowever, it's not an easy task for BaoBao to escape since monsters are everywhere in the city! For all $1 \\le i \\le n$, $d_i$ monsters are wandering near the $i$ -th spot, so right after BaoBao arrives at that spot, at most $d_i$ paths connecting the spot will be blocked by monsters and are unable for BaoBao to pass. When BaoBao leaves the $i$ -th spot, the monsters will go back to their nests and the blocked paths are clear. Of course, if BaoBao comes back to the spot, at most $d_i$ paths will be again blocked by the monsters. The paths blocked each time may differ.\n\nAs BaoBao doesn't know which paths will be blocked, please help him calculate the shortest time he can escape from the city in the worst case.",
    "input": "There are multiple test cases. The first line of the input contains an integer $T$ (about $100$), indicating the number of test cases. For each test case: The first line contains three integers $n$, $m$ and $k$ ($1 \\le n \\le 10^5$, $1 \\le m \\le 10^6$, $1 \\le k \\le n$), indicating the number of spots, the number of undirected paths and the number of exits of the city. The second line contains $k$ distinct integers $e_1, e_2, \\dots, e_k$ ($1 \\le e_i \\le n$), indicating $k$ exits of Heltion City. The third line contains $n$ integers $d_1, d_2, \\dots, d_n$ ($0 \\le d_i \\le m$), where $d_i$ indicates the number of monsters at the $i$ -th spot. For the following $m$ lines, the $i$ -th line contains three integers $x_i$, $y_i$ and $w_i$ ($1 \\le x_i,y_i \\le n$, $x_i \\neq y_i$, $1 \\le w_i \\le 10^4$), indicating an undirected edge of length $w_i$ connecting spot $x_i$ and $y_i$. It's guaranteed that the total sum of $n$ will not exceed $10^6$ and the total sum of $m$ will not exceed $3 \\times 10^6$.",
    "output": "For each case output one line containing one integer. If BaoBao can get to some exit in the worst case, output the shortest possible time cost; Otherwise if BaoBao cannot get to any exit in the worst case, output \"-1\" (without quotes) instead.",
    "constraints": "time limit per test 4 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM105427A",
    "source": "icpc_gym",
    "title": "A. Aperiodic Appointments",
    "description": "Nick has always struggled with maintaining habits. The problem is that he just can't stop maintaining them. If Nick does something $K$ times in a row, he has to keep doing it forever.\n\nLuckily, he has started visiting Dr Patternson, an expert in PBT (Pattern Breaking Therapy). The principle of PBT is simple: Nick will visit Dr Patternson every day, and if he has done the same thing $K$ times in a row on a specific visit, the doctor will charge him money. This will motivate Nick to not continue this habit.\n\nPBT has worked out great for Nick, as he has now successfully quit all his habits. Except for one, the habit of visiting Dr Patternson. The frequent visits are starting to take a toll on Nick's economy, so your task is to calculate how many times he has to pay the doctor for the next $N$ days.\n\nFormally, let $s = s_1s_2s_3\\dots s_N$ be a string consisting of zeroes and ones. A one means that Nick has to pay the doctor on the $i$th day. This string is generated one character at a time, in the following way:\n\nYou are given the numbers $N$ and $K$, and your task is to calculate the number of ones in the string $s$.",
    "input": "The input consists of one line with the integers $N$ and $K$ ($1 \\leq N \\leq 10^9$, $2 \\leq K \\leq 10^9$).",
    "output": "Print one integer, the number of ones in the string $s$.",
    "constraints": "time limit per test 1 second\nmemory limit per test 512 megabytes"
  },
  {
    "problem_id": "P13548",
    "source": "luogu",
    "title": "[OOI 2022] Air Reform",
    "description": "CF1648E\n\nBerland --- is a large country with developed airlines. In total, there are $n$ cities in the country that are historically served by the Berlaflot airline. The airline operates bi-directional flights between $m$ pairs of cities, $i$-th of them connects cities with numbers $a_i$ and $b_i$ and has a price $c_i$ for a flight in both directions.\n\nIt is known that Berlaflot flights can be used to get from any city to any other (possibly with transfers), and the cost of any route that consists of several consequent flights is equal to the cost of the most expensive of them. More formally, the cost of the route from the city $t_1$ to the city $t_k$ with $(k-2)$ transfers in cities $t_2,\\ t_3,\\ t_4,\\ \\ldots,\\ t_{k - 1}$ is equal to the maximum cost of flights from $t_1$ to $t_2$, from $t_2$ to $t_3$, from $t_3$ to $t_4$ and so on until the flight from $t_{k - 1}$ to $t_k$. Of course, all these flights must be operated by Berlaflot Airline.\n\nA new airline, S8 Airlines, has recently started operating in Berland. This airline provides bi-directional flights between all pairs of cities that are not connected by Berlaflot flights. Thus, between each pair of cities there is a flight of either Berlaflot or S8 Airlines.\n\nThe cost of S8 Airlines flights is calculated as follows: for each pair of cities $x$ and $y$ that is connected by a S8 Airlines flight, the cost of this flight is equal to the minimum cost of the route between the cities $x$ and $y$ at Berlaflot according to the pricing described earlier.\n\nIt is known that with the help of S8 Airlines flights you can get from any city to any other with possible transfers, and, similarly to Berlaflot, the cost of the route between any two cities that consists of several S8 Airlines flights is equal to the cost of the most expensive flight.\n\nDue to increased competition with S8 Airlines, Berlaflot decided to introduce an air reform and change the costs of its flights. Namely, for the $i$-th of its flight between the cities $a_i$ and $b_i$, Berlaflot wants to make the cost of this flight equal to the minimum cost of the route between the cities $a_i$ and $b_i$ at S8 Airlines. Help Berlaflot managers calculate new flight costs.",
    "input": "Each test consists of multiple test cases. The first line contains two integers $t$ and $g$ ($1 \\le t \\le 10\\,000$, $0 \\le g \\le 8$) --- the amount of test cases and the number of the group which this test belongs to. Description of the test cases follows.\n\nThe first line of each test case contains two integers $n$ and $m$ ($4 \\le n \\le 200\\,000$, $n - 1 \\le m \\le 200\\,000$, $m \\le \\frac{(n - 1) (n - 2)}{2}$) --- the amount of cities in Berland and the amount of Berlaflot flights.\n\nThe next $m$ lines contain the description of Berlaflot flights. $i$-th line contains three integers $a_i$, $b_i$ and $c_i$ ($1 \\le a_i, b_i \\le n$, $1 \\le c_i \\le 10^9$) --- the numbers of cities that are connected with $i$-th Berlaflot flight and the price of $i$-th Berlaflot flight.\n\nIt is guaranteed that no flight connects a city with itself, no 2 flights connect the same pair of cities. It is guaranteed that by using Berlaflot flights it is possible to get from any city to any other and by using S8 Airlines flights it is possible to get from any city to any other.\n\nLet $N$ be the sum of $n$ over all test cases and $M$ be the sum of $m$ over all test cases. It is guaranteed that $N, M \\le 200\\,000$.",
    "output": "For each test case you should print $m$ integers in a single line, $i$-th of them should be the price of $i$-th Berlaflot flight after the air reform.",
    "constraints": ""
  },
  {
    "problem_id": "CF360C",
    "source": "codeforces",
    "title": "C. Levko and Strings",
    "description": "Levko loves strings of length n, consisting of lowercase English letters, very much. He has one such string s. For each string t of length n, Levko defines its beauty relative to s as the number of pairs of indexes i, j (1 ≤ i ≤ j ≤ n), such that substring t [i.. j] is lexicographically larger than substring s [i.. j].\n\nThe boy wondered how many strings t are there, such that their beauty relative to s equals exactly k. Help him, find the remainder after division this number by 1000000007 (10 9 + 7).\n\nA substring s [i.. j] of string s = s 1 s 2... s n is string s i s i +  1... s j.\n\nString x = x 1 x 2... x p is lexicographically larger than string y = y 1 y 2... y p, if there is such number r (r < p), that x 1 = y 1, x 2 = y 2,  ..., x r = y r and x r +  1 > y r +  1. The string characters are compared by their ASCII codes.",
    "input": "The first line contains two integers n and k (1 ≤ n ≤ 2000, 0 ≤ k ≤ 2000). The second line contains a non-empty string s of length n. String s consists only of lowercase English letters.",
    "output": "Print a single number — the answer to the problem modulo 1000000007 (10 9 + 7).",
    "constraints": "time limit per test 1 second\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM105637F",
    "source": "icpc_gym",
    "title": "F. Ammunition Storage",
    "description": "The Do-Barareh military area is like an $n\\times m$ grid, each cell of which has a specific height. The commander of this military area is looking for a rectangular sub-area of this area, with width and height least $2$, whose its four corner cells are higher than the rest of its cells. He plans to install watchtowers in the corners of this sub-area to monitor the entire sub-area and use it for ammunition storage. Your job is to help the commander to find out how many valid sub-areas there are to choose as the ammunition storage. You can assume cell heights are distinct.",
    "input": "The first line of input contains two space-separated integers $n$ and $m$ ($2 \\leq n, m \\leq 750$). Each of the next $n$ lines contains $m$ space-separated integers showing the cell heights. It is guaranteed cell heights are distinct numbers between $1$ and $nm$ (inclusive).",
    "output": "Print the number of valid sub-areas to be used as an ammunition storage.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 512 megabytes"
  },
  {
    "problem_id": "P5313",
    "source": "luogu",
    "title": "[Ynoi2011] WBLT",
    "description": "时间大概在学科夏令营那段时间：\n\n当时信息组的其他几个还有新高二的同学都开始学splay了，每天听到zms和yjq（一个学长，很强）讨论splay，还戏称为\"spaly\"，就感觉很紧张，他们怎么学这么厉害的东西，我还完全不了解。\n\n然后我上网查了查splay，看到几百行的代码，看到什么zig，zag，势能分析（所以说写的这么丑的博客为什么会排前几），就感觉这个东西无法理解，大概看了看也没看懂。\n\n去问了问于神splay的功能是什么——“插入，删除，查询第k小”\n\n反正天天也无聊，于是就想了想：\n\n线段树可以查第k小，只需要让其叶子sorted即可。\n\n所以线段树是不是也能做？\n\n但是我们的线段树是一个静态的结构（当时的想法），这个东西要动态化才行，不然如何插入删除？\n\n线段树维护了每个点的区间，这个东西是静态的，也就是问题所在，我们考虑如何动态化这个东西：\n\n插入一个节点的时候，如果找到了插入位置，那么一定是一个叶子，我们可以给这个节点新建两个叶子的儿子。\n\n可以发现这个插入位置后面的所有节点都进行了平移，于是我们可以考虑对这个进行打标记来维护，称为平移标记，每次push_down平移标记来实现动态化。\n\n每次删除的时候可以使用其兄弟来代替被删除的节点，同理需要进行平移标记的维护。\n\n查询的时候先push_down平移标记，然后考虑是否进入左儿子即可。\n\n可以发现这样的结构在插入链式数据下复杂度会有问题，考虑如何平衡。\n\n我当时第一个想到的是设定一个ratio，使得左右儿子的比例在ratio之内，否则暴力重构，写了写发现好像是对的，去问于神，然后他说这个就是“替罪羊树”......\n\n诶所以我自己发明平衡树了？\n\n这么看来平衡树很简单啊。\n\n这么看来我很强啊（错觉）。\n\n然后我就一直按这个思路想下去了，想了很多种奇怪的写法，比如不平衡的时候合并一下，或者按中点分裂什么的。\n\n我乱写了一个策略，通过了平衡树模板题，但是当时写的非常复杂，因为我维护了父亲，而且写法未经过优化。\n\n后来发现不需要所谓的平移标记，可以直接维护size，这样可以按相对位置二分下去，减少了很多代码量。\n\n发现可以不存father，减少了很多代码量。\n\n又发现这个树也是可以”旋转“的，我们将旋转定义为合并两个节点即可（所以我看到说什么”无旋treap不用旋转，和treap不一样“的言论都感觉很谔谔，因为本身就是等价操作，同一个东西写出来不一样而已）。\n\n同时也是可以分裂的，这里我分裂定义为了经过 $O( logn )$ 次旋转使得根的左儿子的右儿子是我们需要的区间。\n\n我发现我设计出的平衡树的确是可以支持所有操作的，复杂度也都是 $O( logn )$ ，而且个人认为这个很好写。\n\n所以我发明平衡树了？\n\n当时起了个名字“自平衡线段树”——“Self Balancing Segment Tree”，虽然后来查了很久发现其实是把两个OI界中未引入的东西结合在了一起，应该叫做“Weight Balanced Leafy Tree”\n\n刚做出来的时候觉得这个是很重要的东西，于是对其他人都藏着掖着，生怕同学们学到我的技术，因为我当时也知道，省队就5个名额，同学都是我的竞争对手。\n\n当时mhy听说我的平衡树很强，就问我能不能10分钟写出来，我接受了挑战，然后还真的写出来了，得到了集训队爷的认可+1\n\n当时就对自己充满了自信，我都能发明这么强的一个数据结构，那进集训队保送清华北大还不是随手的事情吗（flag）。\n\n【记得配图，WBLT的】\n\n由于这是Ynoi，不是出题人拿来写装逼的文字的地方，所以你需要做一个数据结构题：\n\n给你一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n每次查询操作给定参数 $l,r,b$，需输出最大的 $x$，使得存在一个 $a$，满足 $0\\leq a<b$，使得 $a,a+b,a+2b,\\ldots,a+(x-1)b$ 都在区间 $[l,r]$ 内至少出现过一次。\n\n如果不存在 $[0,b-1]$ 内的数，则输出 $0$。",
    "input": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示这个序列。\n\n第三行一个整数 $m$。\n\n之后 $m$ 行，每行三个整数 $l,r,b$，表示一次查询操作。",
    "output": "对于每个查询操作，输出一行一个整数表示答案。",
    "constraints": "对于 $30\\%$ 的数据，所有出现过的数在 $[0,1000]$ 之间。\n对于另外 $30\\%$ 的数据，$b \\leq 1000$。\n对于 $100\\%$ 的数据，所有出现过的数在 $[0,10^5]$ 之间。"
  },
  {
    "problem_id": "GYM103940C",
    "source": "icpc_gym",
    "title": "C. Correcting School Enrollment Errors",
    "description": "Planet E-13 orbits around a star in a faraway galaxy named UAZ. In that planet, everyone attends the same super powerful university, which has the capacity to receive up to $N$ students per semester. Every student gets a school ID, and at the beginning of each semester, each of the students request to enroll in up to eight courses. School enrollment applications are registered by the secretary of the school department, however, given that sometimes she must do it very quickly because the deadlines are very close, students could end up enrolled in courses that they did not request and/or they could have courses they requested to be enrolled in but they were not. Given the list of students with their course requests, and the list of courses in which they actually ended up enrolled in the school system, your job is to provide a list of changes to be made to the school system's records, so that effectively the students end up enrolled in each and every one of the courses they requested, without having missing or unrequested courses.",
    "input": "In the first line of input there will be two integers $N$ and $M$ $(1 \\leq N, M \\leq 10^5)$, the number of students requesting at least one course enrollment this semester and the number of students that got at least one course enrollment this semester, respectively. The next $N$ lines, start with two integers $A$ $(1 \\leq A \\leq 10^7)$ and $B$ $(1 \\leq B \\leq 8)$, the ID of the student and the number of class enrollments student $A$ is requesting respectively. Then in the same line will be $B$ integers $b_i$ $(1 \\leq b_i \\leq 10^4)$, this are the enrollment requests by student $A$. The next $M$ lines, start with two integers $A$ $(1 \\leq A \\leq 10^7)$ and $C$ $(1 \\leq C \\leq 8)$, the ID of the student and the number of class enrollments student $A$ received. Then in the same line will be $C$ integers $c_i$ $(1 \\leq c_i \\leq 10^4)$, this are the enrollments assigned to the student $A$ by the school. note: students and enrollment lists will appear in any order.",
    "output": "If there was no error in enrollments, you should print \"GREAT WORK! NO MISTAKES FOUND!\" in one line, without quotes. Otherwise you need to print the changes needed in enrollment such that all students get exactly the courses they requested, not more, not less. For each student that needs a change in their enrollment there will be a line: the ID of the student followed by a list of corrections separated by spaces, a correction is of type $-m$ or $+m$, which are removing a course and adding a course respectively, the list should be printed ordered in ascending order of the absolute value of $m$. The ID's of students should appear in ascending order, also corrections should be ordered in ascending order for each student. Once all of the changes are listed (ordered by student ID and course ID), you should print the text \"MISTAKES IN X STUDENTS: Y NOT REQUESTED, Z MISSED\" (without the quotes) replacing X for the number of students that had mistakes in the system, Y for the total number of course enrollments registered in the system that were not requested by the students and Z for the total number of course enrollments that were requested but were not in the system",
    "constraints": "time limit per test 1 second\nmemory limit per test 1024 megabytes"
  },
  {
    "problem_id": "GYM101915B",
    "source": "icpc_gym",
    "title": "B. Ali and Wi-Fi",
    "description": "Ali lives in a very crowded city and a very large apartment. His apartment looks like an almost infinite 2 D plane. In this city almost all his neighbors have WiFi networks, except for him. Precisely, from his apartment his laptop can receive N WiFi networks.\n\nOne day Ali wrote a program that can hack his neighbors' WiFi networks. Furthermore, he learned how to stand in a point, hack almost all the WiFi networks that reaches that point, and join them in one ultra-speed network.\n\nEach WiFi network is described as a circle with its center on the point (x, y), a radius equal to R and a network speed equal to S.\n\nHowever, Ali's program can join at most M networks. When Ali's program joins many networks, the resulting network will have the total sum for speeds of all networks.\n\nAli wants to choose a point at his apartment that will get him the maximum total speed of WiFi networks. Can you help him calculate the maximum total WiFi network speed he can get if he chooses his location optimally?",
    "input": "The first line contains an integer T, the number of test cases. The first line of each test contains (1 ≤ N ≤ 100) the number of WiFi networks and (1 ≤ M ≤ 100) the maximum number of networks Ali can join. The following N line contains the description of N WiFi networks. The center coordinates (0 ≤ x, y ≤ 10 3), the radius (1 ≤ R ≤ 10 3) and the network speed (0 ≤ S ≤ 10 6).",
    "output": "For each test case print a single line, containing a single integer, denoting the maximum total WiFi network speed Ali can get, if he chooses his location optimally.",
    "constraints": "time limit per test 6 seconds\nmemory limit per test 64 megabytes"
  },
  {
    "problem_id": "CF496E",
    "source": "codeforces",
    "title": "E. Distributing Parts",
    "description": "You are an assistant director in a new musical play. The play consists of n musical parts, each part must be performed by exactly one actor. After the casting the director chose m actors who can take part in the play. Your task is to assign the parts to actors. However, there are several limitations.\n\nFirst, each actor has a certain voice range and there are some parts that he cannot sing. Formally, there are two integers for each actor, c i and d i (c i ≤ d i) — the pitch of the lowest and the highest note that the actor can sing. There also are two integers for each part — a j and b j (a j ≤ b j) — the pitch of the lowest and the highest notes that are present in the part. The i -th actor can perform the j -th part if and only if c i ≤ a j ≤ b j ≤ d i, i.e. each note of the part is in the actor's voice range.\n\nAccording to the contract, the i -th actor can perform at most k i parts. Besides, you are allowed not to give any part to some actors (then they take part in crowd scenes).\n\nThe rehearsal starts in two hours and you need to do the assignment quickly!",
    "input": "The first line contains a single integer n — the number of parts in the play (1 ≤ n ≤ 10 5). Next n lines contain two space-separated integers each, a j and b j — the range of notes for the j -th part (1 ≤ a j ≤ b j ≤ 10 9). The next line contains a single integer m — the number of actors (1 ≤ m ≤ 10 5). Next m lines contain three space-separated integers each, c i, d i and k i — the range of the i -th actor and the number of parts that he can perform (1 ≤ c i ≤ d i ≤ 10 9, 1 ≤ k i ≤ 10 9).",
    "output": "If there is an assignment that meets all the criteria aboce, print a single word \" YES \" (without the quotes) in the first line. In the next line print n space-separated integers. The i -th integer should be the number of the actor who should perform the i -th part. If there are multiple correct assignments, print any of them. If there is no correct assignment, print a single word \" NO \" (without the quotes).",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF1830D",
    "source": "codeforces",
    "title": "D. Mex Tree",
    "description": "You are given a tree with $n$ nodes. For each node, you either color it in $0$ or $1$.\n\nThe value of a path $(u,v)$ is equal to the MEX $^\\dagger$ of the colors of the nodes from the shortest path between $u$ and $v$.\n\nThe value of a coloring is equal to the sum of values of all paths $(u,v)$ such that $1 \\leq u \\leq v \\leq n$.\n\nWhat is the maximum possible value of any coloring of the tree?\n\n$^{\\dagger}$ The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:",
    "input": "Each test contains multiple test cases. The first line of input contains a single integer $t$ ($1 \\le t \\le 10^4$) — the number of test cases. The description of test cases follows. The first line of each test case contains a single integer $n$ ($1 \\le n \\le 2 \\cdot 10^5$) — the number of nodes in the tree. The following $n-1$ lines of each test case contains $2$ integers $a_i$ and $b_i$ ($1 \\leq a_i, b_i \\leq n, a_i \\neq b_i$) — indicating an edge between vertices $a_i$ and $b_i$. It is guaranteed that the given edges form a tree. It is guaranteed that the sum of $n$ across all test cases does not exceed $2 \\cdot 10^5$.",
    "output": "For each test case, print the maximum possible value of any coloring of the tree.",
    "constraints": "time limit per test 3 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "P2155",
    "source": "luogu",
    "title": "[SDOI2008] 沙拉公主的困惑",
    "description": "大富翁国因为通货膨胀，以及假钞泛滥，政府决定推出一项新的政策：现有钞票编号范围为 $1$ 到 $N$ 的阶乘，但是，政府只发行编号与 $M!$ 互质的钞票。房地产第一大户沙拉公主决定预测一下大富翁国现在所有真钞票的数量。现在，请你帮助沙拉公主解决这个问题，由于数量可能非常大，你只需计算出答案对 $R$ 取模后的结果即可。",
    "input": "第一行为两个整数 $T$ 和 $R$，其中 $T$ 为该组中测试数据数目，$R$ 为模数。\n\n接下来 $T$ 行，每行一对整数 $N$ 和 $M$，具体意义见题目描述。",
    "output": "共 $T$ 行，对于每一对 $N$ 和 $M$，输出 $[1, N!]$ 中与 $M!$ 互质的数的数量对 $R$ 取模后的值。",
    "constraints": "对于 $100\\% $ 的数据，$1\\leq M\\leq N\\leq 10^7$，$1\\leq T\\leq 10^4$，$2\\leq R\\leq 10^9+10$ 且 $R$ 为质数。"
  },
  {
    "problem_id": "GYM104375A",
    "source": "icpc_gym",
    "title": "A. Aliases",
    "description": "You are designing a new system called NAME (Notable Aliases with Meaning and Essence) that transforms people's names into meaningful aliases. The process involves taking the first letter of each name.\n\nFor example, the name \"Jose Osorio Jimenez Orozco\" would have the NAME \"JOJO\".\n\nHowever, a problem arises if two people have the same NAME, as it loses its essence and is no longer unique.\n\nGiven a list of full names for all the members, your task is to determine how many unique NAMEs there are.",
    "input": "An integer $N$ describes the number of names of the members ($1 \\leq N \\leq 10000$). Following will be $N$ lines, each one starting with an integer $X_i$ ($1 \\leq X_i \\leq 20$) describing total words in the full name of the person $i$, following that there will be $X_i$ words representing the name of the person $i$. Each word is consisting on only lowercase letters.",
    "output": "A single integer representing the number of uniques NAMEs",
    "constraints": "time limit per test 1 second\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF727D",
    "source": "codeforces",
    "title": "D. T-shirts Distribution",
    "description": "The organizers of a programming contest have decided to present t-shirts to participants. There are six different t-shirts sizes in this problem: S, M, L, XL, XXL, XXXL (sizes are listed in increasing order). The t-shirts are already prepared. For each size from S to XXXL you are given the number of t-shirts of this size.\n\nDuring the registration, the organizers asked each of the n participants about the t-shirt size he wants. If a participant hesitated between two sizes, he could specify two neighboring sizes — this means that any of these two sizes suits him.\n\nWrite a program that will determine whether it is possible to present a t-shirt to each participant of the competition, or not. Of course, each participant should get a t-shirt of proper size:\n\nIf it is possible, the program should find any valid distribution of the t-shirts.",
    "input": "The first line of the input contains six non-negative integers — the number of t-shirts of each size. The numbers are given for the sizes S, M, L, XL, XXL, XXXL, respectively. The total number of t-shirts doesn't exceed 100 000. The second line contains positive integer n (1 ≤ n ≤ 100 000) — the number of participants. The following n lines contain the sizes specified by the participants, one line per participant. The i -th line contains information provided by the i -th participant: single size or two sizes separated by comma (without any spaces). If there are two sizes, the sizes are written in increasing order. It is guaranteed that two sizes separated by comma are neighboring.",
    "output": "If it is not possible to present a t-shirt to each participant, print « NO » (without quotes). Otherwise, print n + 1 lines. In the first line print « YES » (without quotes). In the following n lines print the t-shirt sizes the orginizers should give to participants, one per line. The order of the participants should be the same as in the input. If there are multiple solutions, print any of them.",
    "constraints": "time limit per test 1 second\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "P2542",
    "source": "luogu",
    "title": "[AHOI2005] 航线规划",
    "description": "对 Samuel 星球的探险已经取得了非常巨大的成就，于是科学家们将目光投向了 Samuel 星球所在的星系——一个巨大的由千百万星球构成的 Samuel 星系。\n\n星际空间站的 Samuel II 巨型计算机经过长期探测，已经锁定了 Samuel 星系中 $n$ 个星球的空间坐标，并对这些星球以 $1$ 至 $n$ 依次编号。\n\n一些先遣飞船已经出发，在星球之间开辟探险航线。\n\n探险航线是双向的，例如从 $1$ 号星球到 $3$ 号星球开辟探险航线，那么从 $3$ 号星球到 $1$ 号星球也可以使用这条航线。\n\n例如下图所示：\n\n ![](https://cdn.luogu.com.cn/upload/pic/1644.png) \n\n在 $5$ 个星球之间，有 $5$ 条探险航线。\n\n$A,B$ 两星球之间，如果某条航线不存在，就无法从 $A$ 星球抵达 $B$ 星球，我们则称这条航线为关键航线。\n\n显然上图中，$1$ 号与 $5$ 号星球之间的关键航线有 $1$ 条：即为 $4\\leftrightarrow5$ 航线。\n\n然而，在宇宙中一些未知的磁暴和行星的冲撞，使得已有的某些航线被破坏，随着越来越多的航线被破坏，探险飞船又不能及时恢复这些航线，可见两个星球之间的关键航线会越来越多。\n\n假设在上图中，航线 $4\\leftrightarrow2$（从 $4$ 号星球到 $2$ 号星球）被破坏。此时，$1$ 号与 $5$ 号星球之间的关键航线就有 $3$ 条：$1 \\leftrightarrow 3$，$3 \\leftrightarrow 4$，$4 \\leftrightarrow 5$。\n\n小联的任务是，不断关注航线被破坏的情况，并随时给出两个星球之间的关键航线数目。现在请你帮助完成。",
    "input": "第一行有两个整数，分别表示星球个数 $n$ 和初始时的航线条数 $m$。\n\n接下来 $m$ 行，每行有两个不相同的整数 $u, v$，表示星球 $u$ 和星球 $v$ 之间存在一条航线。\n\n接下来有若干行，每行首先给出一个整数 $op$，表示一次操作的类型。\n\n- 若 $op = 1$，则后接两个整数 $u, v$，表示询问当前 $u, v$ 两星球之间有多少关键航线。\n- 若 $op = 0$，则后接两个整数 $u, v$，表示 $u, v$ 之间的航线被破坏。\n- 若 $op = -1$，则表示输入结束，后面不再存在操作。",
    "output": "对每个 $op = 1$ 的询问，输出一行一个整数表示关键航线数目。",
    "constraints": "#### 数据规模与约定\n对于全部的测试点，保证：\n- $1 \\leq n \\leq 3 \\times 10^4$，$1 \\leq m \\leq 10^5$。\n- $-1 \\leq op \\leq 1$，$1 \\leq u, v \\leq n$。\n- 无论航线如何被破坏，任意时刻任意两个星球都能够相互到达。在整个数据中，任意两个星球之间最多只可能存在一条直接的航线。\n- 对于 $op = 0$ 的操作，保证操作前航线 $u \\leftrightarrow v$ 存在。\n- 询问与破坏航线的总次数不超过 $4 \\times 10^4$。\nUpdate :2025.6.27 添加一组数据。"
  },
  {
    "problem_id": "CF1670E",
    "source": "codeforces",
    "title": "E. Hemose on the Tree",
    "description": "After the last regional contest, Hemose and his teammates finally qualified to the ICPC World Finals, so for this great achievement and his love of trees, he gave you this problem as the name of his team \"Hemose 3al shagra\" (Hemose on the tree).\n\nYou are given a tree of $n$ vertices where $n$ is a power of $2$. You have to give each node and edge an integer value in the range $[1,2n -1]$ (inclusive), where all the values are distinct.\n\nAfter giving each node and edge a value, you should select some root for the tree such that the maximum cost of any simple path starting from the root and ending at any node or edge is minimized.\n\nThe cost of the path between two nodes $u$ and $v$ or any node $u$ and edge $e$ is defined as the bitwise XOR of all the node's and edge's values between them, including the endpoints (note that in a tree there is only one simple path between two nodes or between a node and an edge).",
    "input": "The first line contains a single integer $t$ ($1 \\le t \\le 5\\cdot 10^4$) — the number of test cases. Then $t$ test cases follow. The first line of each test case contains a single integer $p$ ($1 \\le p \\le 17$), where $n$ (the number of vertices in the tree) is equal to $2^p$. Each of the next $n−1$ lines contains two integers $u$ and $v$ ($1 \\le u,v \\le n$) meaning that there is an edge between the vertices $u$ and $v$ in the tree. It is guaranteed that the given graph is a tree. It is guaranteed that the sum of $n$ over all test cases doesn't exceed $3\\cdot 10^5$.",
    "output": "For each test case on the first line print the chosen root. On the second line, print $n$ integers separated by spaces, where the $i$ -th integer represents the chosen value for the $i$ -th node. On the third line, print $n-1$ integers separated by spaces, where the $i$ -th integer represents the chosen value for the $i$ -th edge. The edges are numerated in the order of their appearance in the input data. If there are multiple solutions, you may output any.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "CF682E",
    "source": "codeforces",
    "title": "E. Alyona and Triangles",
    "description": "You are given n points with integer coordinates on the plane. Points are given in a way such that there is no triangle, formed by any three of these n points, which area exceeds S.\n\nAlyona tried to construct a triangle with integer coordinates, which contains all n points and which area doesn't exceed 4 S, but, by obvious reason, had no success in that. Please help Alyona construct such triangle. Please note that vertices of resulting triangle are not necessarily chosen from n given points.",
    "input": "In the first line of the input two integers n and S (3 ≤ n ≤ 5000, 1 ≤ S ≤ 10 18) are given — the number of points given and the upper bound value of any triangle's area, formed by any three of given n points. The next n lines describes given points: i th of them consists of two integers x i and y i ( - 10 8 ≤ x i, y i ≤ 10 8) — coordinates of i th point. It is guaranteed that there is at least one triple of points not lying on the same line.",
    "output": "Print the coordinates of three points — vertices of a triangle which contains all n points and which area doesn't exceed 4 S. Coordinates of every triangle's vertex should be printed on a separate line, every coordinate pair should be separated by a single space. Coordinates should be an integers not exceeding 10 9 by absolute value. It is guaranteed that there is at least one desired triangle. If there is more than one answer, print any of them.",
    "constraints": "time limit per test 3 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "P11455",
    "source": "luogu",
    "title": "[USACO24DEC] Cowdependence G",
    "description": "Farmer John 的 $N$（$1 \\leq N \\leq 10^5$）头奶牛已经排成一行。第 $i$ 头奶牛的标号是 $a_i$（$1 \\leq a_i \\leq N$）。如果一些奶牛具有相同的标号，并且他们两两之间的距离都在 $x$ 头牛以内，那么这些奶牛可以组成一个友谊小组（$x$ 是范围 $[1,N]$ 内的一个整数）。每头奶牛必须恰好属于一个友谊小组。\n\n对于从 $1$ 到 $N$ 的每一个 $x$，计算可能组成的友谊小组的最小数量。",
    "input": "输入的第一行包含一个整数 $N$。\n\n下一行包含 $a_1 \\dots a_N$，为每头奶牛的标号。",
    "output": "对于从 $1$ 到 $N$ 的每一个 $x$ 输出一行，包含该 $x$ 所对应的友谊小组的最小数量。",
    "constraints": "以下为当 $x=1$ 和 $x=2$ 时将奶牛以最小化小组数量的方式组成友谊小组的一些例子。每个字母对应一个不同的小组。\nx = 1: A B B C D E F G G（7 组）\nx = 1: A A B C D E F G G（7 组，另一种分组方案）\nx = 2: A A A B C D C E E（5 组）\nx = 2: A A A B C D C D E（5 组，另一种分组方案）\n- 测试点 $4\\sim 7$：对于所有 $i$ 有 $a_i\\leq 10$。\n- 测试点 $8\\sim 11$：没有标号出现超过 $10$ 次。\n- 测试点 $12\\sim 20$：没有额外限制。"
  },
  {
    "problem_id": "CF992E",
    "source": "codeforces",
    "title": "E. Nastya and King-Shamans",
    "description": "Nastya likes reading and even spends whole days in a library sometimes. Today she found a chronicle of Byteland in the library, and it stated that there lived shamans long time ago. It is known that at every moment there was exactly one shaman in Byteland, and there were n shamans in total enumerated with integers from 1 to n in the order they lived. Also, each shaman had a magic power which can now be expressed as an integer.\n\nThe chronicle includes a list of powers of the n shamans. Also, some shamans can be king-shamans, if they gathered all the power of their predecessors, i.e. their power is exactly the sum of powers of all previous shamans. Nastya is interested in whether there was at least one king-shaman in Byteland.\n\nUnfortunately many of the powers are unreadable in the list, so Nastya is doing the following:\n\nUnfortunately the list is too large and Nastya wants you to help her.",
    "input": "The first line contains two integers n and q (1 ≤ n, q ≤ 2·10 5). The second line contains n integers a 1, ..., a n (0 ≤ a i ≤ 10 9), where a i is the magic power of the i -th shaman. After that q lines follow, the i -th of them contains two integers p i and x i (1 ≤ p i ≤ n, 0 ≤ x i ≤ 10 9) that mean that the new power of the p i -th shaman is x i.",
    "output": "Print q lines, the i -th of them should contain - 1, if after the i -th change there are no shaman-kings, and otherwise a single integer j, where j is an index of some king-shaman after the i -th change. If there are multiple king-shamans after each change, print the index of any of them.",
    "constraints": "time limit per test 3 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "P15006",
    "source": "luogu",
    "title": "[UOI 2019 II Stage] 节日",
    "description": "众所周知，波托科兰迪亚王国的居民是非常严谨细致的人。即使是在节日这件事上，他们也总是希望确保一切都能顺利进行。因此，所有节日的日程都提前一百年就安排好了。哥萨克胡子决定邀请他的朋友——哥萨克耳朵，前来王国中的某个城市，并尽可能多地参加节日。\n\n王国有 $n$ 个城市，通过 $n-1$ 条双向道路连接，使得从任何一个城市都可以到达另一个城市（可能需要经过其他城市）。通过第 $i$ 条道路需要 $l_i$ 天时间。\n\n波托科兰迪亚的每个节日由举办城市的编号 $c_i$ 和举办日期的编号 $d_i$ 来描述。哥萨克耳朵在庆祝上不花费太多时间。因此，如果他在第 $i$ 天庆祝，那么他可以在同一天出发，并在第二天到达另一个城市（如果存在一条 $l_i = 1$ 的道路），并参加庆祝（如果该城市有节日）。\n\n哥萨克胡子的这位朋友非常幸运，他抵达王国的日期在日历上的编号是 $0$，并且他一开始可以选择到达王国的任何一个城市。哥萨克胡子想知道，他的朋友最多能参加多少个节日。为此，他向您求助。请帮助他解决这个问题！",
    "input": "第一行包含一个整数 $n$ ($1 \\le n \\le 2 \\cdot 10^5$) —— 王国中的城市数量。\n\n接下来的 $n-1$ 行，每行包含三个整数 $a_i$、$b_i$ 和 $l_i$ ($1 \\le a_i, b_i \\le n$, $1 \\le l_i \\le 10^9$) —— 表示道路连接的两个城市的编号，以及通过该道路所需的天数。保证图是连通的。\n\n下一行包含一个整数 $m$ ($1 \\le m \\le 2 \\cdot 10^5$) —— 王国中的节日数量。\n\n接下来的 $m$ 行，每行包含两个整数 $c_i$ 和 $d_i$ ($1 \\le c_i \\le n$, $1 \\le d_i \\le 10^9$) —— 表示第 $i$ 个节日的举办城市编号和举办日期。",
    "output": "输出一个数字 —— 哥萨克耳朵最多能够参加的节日数量。",
    "constraints": ""
  },
  {
    "problem_id": "GYM104064A",
    "source": "icpc_gym",
    "title": "A. Access Denied",
    "description": "Computer passwords have been around for a long time. In fact, 60 years ago CTSS was one of the first computers with a password. The implementation of this was very simple. In CTSS the password was stored in plain text in a file on disk. When logging in, the user would enter a password. The computer would then compare the password to the password on disk. If the comparison failed, it would deny access, if it succeeded, access would be allowed. Researchers at MIT were quick to discover several security flaws in this password system. We will explore one of them, the timing attack.\n\nIn a timing attack, we exploit that we can deduce a computation path from the time it takes to do the computation. In CTSS the password check was done using a simple string matching algorithm, similar to this:\n\nFor the purpose of this problem, we will use a (very) simplified timing model and the above algorithm. The timing model looks as follows:\n\nThe password consists of between $1$ and $20$ English letters, upper or lower case, and digits.\n\nThis is an interactive problem. Your submission will be run against an interactor, which reads the standard output of your submission and writes to the standard input of your submission. This interaction needs to follow a specific protocol:",
    "input": "",
    "output": "",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 512 megabytes"
  },
  {
    "problem_id": "CF493E",
    "source": "codeforces",
    "title": "E. Vasya and Polynomial",
    "description": "Vasya is studying in the last class of school and soon he will take exams. He decided to study polynomials. Polynomial is a function P (x) = a 0 + a 1 x 1 + ... + a n x n. Numbers a i are called coefficients of a polynomial, non-negative integer n is called a degree of a polynomial.\n\nVasya has made a bet with his friends that he can solve any problem with polynomials. They suggested him the problem: \"Determine how many polynomials P (x) exist with integer non-negative coefficients so that, and, where and b are given positive integers\"?\n\nVasya does not like losing bets, but he has no idea how to solve this task, so please help him to solve the problem.",
    "input": "The input contains three integer positive numbers no greater than 10 18.",
    "output": "If there is an infinite number of such polynomials, then print \" inf \" without quotes, otherwise print the reminder of an answer modulo 10 9 + 7.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM102222E",
    "source": "icpc_gym",
    "title": "E. 2-3-4 Tree",
    "description": "In computer science, a 2-3-4 tree, as a search tree, is a self-balancing data structure that is commonly used to implement dictionaries. The numbers mean a tree where every node with children (internal node) has either two, three or four child nodes.\n\nA 2-node is the same as a binary node, which has one data element, and if internal has two child nodes. A 3-node has two data elements, and if internal has three child nodes. A 4-node has three data elements, and if internal has four child nodes. All leaves are at the same depth, and all data is kept in sorted order.\n\nHere we introduce the procedure of inserting a value into a 2-3-4 tree. If the number of values that have been inserted in is no more than $2$, the 2-3-4 tree after the insertion has only one node (the root) with several data elements.\n\nOtherwise, we start the following procedure at the root of the 2-3-4 tree.\n\nNow you are given a 2-3-4 tree which is empty at first. Then we insert $n$ values $a_1, a_2, \\cdots, a_n$ into the 2-3-4 tree one by one. You are asked to write a program to print the 2-3-4 tree after inserting all the given values along the pre-order traversal. For a node with one or more data elements, your program will print these data elements in one line in ascending order.",
    "input": "The input contains several test cases, and the first line is a positive integer $T$ indicating the number of test cases which is up to $50$. For each test case, the first line contains an integer $n~(1 \\le n \\le 5000)$ indicating the number of values that will be inserted into the 2-3-4 tree. The second line contains $n$ integers $a_1, a_2, \\cdots, a_n$. We guarantee that $a_1, a_2, \\cdots, a_{n}$ is a permutation of $1, 2, \\cdots, n$.",
    "output": "For each test case, output a line containing Case #x: at first, where x is the test case number starting from $1$. The following several lines describe the 2-3-4 tree along the pre-order traversal, each line of which describes a node with several integers indicating the data elements of a node in the 2-3-4 tree.",
    "constraints": "time limit per test 10 seconds\nmemory limit per test 256 megabytes"
  },
  {
    "problem_id": "GYM100685G",
    "source": "icpc_gym",
    "title": "G. Gadget Hackwrench",
    "description": "Chip 'n' Dale rescue rangers! But observant viewers know that help is usually required by Chip and Dale themselves. Today you are in the role of cunning Gadget Hackwrench.\n\nSo, Chip and Dale are again in the paws of Fat Cat. He doesn't like rodents much and therefore prepared a treacherous test. He is going to put them to a labyrinth and see if they can escape from it. The labyrinth is actually built as a tree where each edge has fixed direction (by definition tree is a connected unoriented graph without cycles).\n\nGadget has intercepted a talk between Fat Cat and his henchmen about future tests. For each test round she knows the exact location where Chip and Dale are to be put by Fat Cat and the location of an exit. Gadget wants to compute whether they will be able to find an exit for each test.",
    "input": "The first line of input contains an integer N (1 ≤ N ≤ 10 5) — the number of vertices in a graph. On the next N - 1 lines of input directed arcs of the tree are given. On the (i + 1) th line integer numbers a i and b i are given (1 ≤ a i, b i ≤ N) denoting an arc from vertex a i to vertex b i. It is guaranteed that arcs a 1, a 2, ..., a n - 1 without orientation form a tree. Then a string with integer number M (1 ≤ M ≤ 10 5) is given — the number of queries to process. Next M lines describe queries: (n + 1 + i) th line contain integers x i and y i (1 ≤ x i, y i ≤ N).",
    "output": "For each query please output a separate line containing 'Yes' (without quotes) if graph contains a path between x i and y i, or 'No' (without quotes) in other case.",
    "constraints": "time limit per test 2 seconds\nmemory limit per test 64 megabytes"
  }
]