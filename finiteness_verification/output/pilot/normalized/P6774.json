{
  "problem_id": "P6774",
  "source": "luogu",
  "input_structure": [
    {
      "round": 1,
      "status": "success",
      "result": {
        "type": "array",
        "length": {
          "min": 1,
          "max": 100000
        },
        "value_range": {
          "min": 1,
          "max": 100000
        },
        "properties": {
          "ordered": false,
          "inferred": true
        }
      }
    },
    {
      "round": 2,
      "status": "success",
      "result": {
        "type": "array",
        "length": {
          "min": 1,
          "max": 100000
        },
        "value_range": {
          "min": 1,
          "max": 100000
        },
        "properties": {
          "ordered": false,
          "inferred": true
        }
      }
    },
    {
      "round": 3,
      "status": "success",
      "result": {
        "type": "array",
        "length": {
          "min": 1,
          "max": 100000
        },
        "value_range": {
          "min": 1,
          "max": 100000
        },
        "properties": {
          "ordered": false,
          "inferred": true
        }
      }
    }
  ],
  "core_constraints": [
    {
      "round": 1,
      "status": "success",
      "result": {
        "constraints": [
          {
            "name": "event_inclusion",
            "description": "时代 i 包含事件 j 当且仅当 (r_{i,1}, c_{i,1}) ≤ (x_j, y_j) ≤ (r_{i,2}, c_{i,2})",
            "formal": "(r_{i,1}, c_{i,1}) ≤ (x_j, y_j) ≤ (r_{i,2}, c_{i,2})"
          },
          {
            "name": "regret_definition",
            "description": "两个事件 i, j 满足 (x_i, y_i) ≤ (x_j, y_j)，则这两个事件形成了一次遗憾",
            "formal": "(x_i, y_i) ≤ (x_j, y_j)"
          },
          {
            "name": "tears_of_era",
            "description": "一个时代的眼泪的大小是该时代内所有事件形成的遗憾次数",
            "formal": "sum((x_i, y_i) ≤ (x_j, y_j) for all events i, j in era)"
          },
          {
            "name": "special_limit_A",
            "description": "对于所有时代 i，有 c_{i,1} = 1, c_{i,2} = n",
            "formal": "c_{i,1} = 1, c_{i,2} = n"
          },
          {
            "name": "special_limit_B",
            "description": "任意两个不同时代所代表的矩形，它们要么是包含关系（一个矩形在另一个矩形内，边界允许重合），要么是相离关系（两矩形不包含共同点，边界不允许重合）",
            "formal": "For any two eras i and j, either (r_{i,1}, c_{i,1}) ≤ (r_{j,1}, c_{j,1}) and (r_{i,2}, c_{i,2}) ≥ (r_{j,2}, c_{j,2}) or (r_{i,2}, c_{i,2}) < (r_{j,1}, c_{j,1}) or (r_{j,2}, c_{j,2}) < (r_{i,1}, c_{i,1})"
          },
          {
            "name": "special_limit_C",
            "description": "最多有 50 对事件 (i, j) (1 ≤ i < j ≤ n) 不满足 (i, p_i) ≤ (j, p_j)",
            "formal": "count((i, p_i) ≤ (j, p_j) for 1 ≤ i < j ≤ n) ≤ 50"
          }
        ]
      }
    },
    {
      "round": 2,
      "status": "success",
      "result": {
        "constraints": [
          {
            "name": "event_inclusion",
            "description": "时代 i 包含事件 j 当且仅当 (r_{i,1}, c_{i,1}) ≤ (x_j, y_j) ≤ (r_{i,2}, c_{i,2})",
            "formal": "(r_{i,1}, c_{i,1}) ≤ (x_j, y_j) ≤ (r_{i,2}, c_{i,2})"
          },
          {
            "name": "regret_definition",
            "description": "两个事件 i, j 形成一次遗憾当且仅当 (x_i, y_i) ≤ (x_j, y_j)",
            "formal": "(x_i, y_i) ≤ (x_j, y_j)"
          },
          {
            "name": "tears_of_era",
            "description": "一个时代的眼泪的大小是该时代内所有事件形成的遗憾次数",
            "formal": "tears_of_era(i) = |{(j, k) | (x_j, y_j) ≤ (x_k, y_k), 事件 j 和 k 都在时代 i 内}|"
          },
          {
            "name": "special_limit_A",
            "description": "对于所有时代 i，有 c_{i,1} = 1, c_{i,2} = n",
            "formal": "c_{i,1} = 1, c_{i,2} = n"
          },
          {
            "name": "special_limit_B",
            "description": "任意两个不同时代所代表的矩形，它们要么是包含关系（一个矩形在另一个矩形内，边界允许重合），要么是相离关系（两矩形不包含共同点，边界不允许重合）",
            "formal": "对于任意两个时代 i, j，要么 (r_{i,1}, c_{i,1}) ≤ (r_{j,1}, c_{j,1}) 且 (r_{i,2}, c_{i,2}) ≥ (r_{j,2}, c_{j,2})，要么 (r_{i,2}, c_{i,2}) < (r_{j,1}, c_{j,1}) 或 (r_{j,2}, c_{j,2}) < (r_{i,1}, c_{i,1})"
          },
          {
            "name": "special_limit_C",
            "description": "最多有 50 对事件 (i, j) (1 ≤ i < j ≤ n) 不满足 (i, p_i) ≤ (j, p_j)",
            "formal": "|{(i, j) | 1 ≤ i < j ≤ n, (i, p_i) ≰ (j, p_j)}| ≤ 50"
          }
        ]
      }
    },
    {
      "round": 3,
      "status": "success",
      "result": {
        "constraints": [
          {
            "name": "event_inclusion",
            "description": "时代 i 包含事件 j 当且仅当 (r_{i,1}, c_{i,1}) ≤ (x_j, y_j) ≤ (r_{i,2}, c_{i,2})",
            "formal": "(r_{i,1}, c_{i,1}) ≤ (x_j, y_j) ≤ (r_{i,2}, c_{i,2})"
          },
          {
            "name": "regret_definition",
            "description": "两个事件 i, j 形成一次遗憾当且仅当 (x_i, y_i) ≤ (x_j, y_j)",
            "formal": "(x_i, y_i) ≤ (x_j, y_j)"
          },
          {
            "name": "tears_of_era",
            "description": "一个时代的眼泪的大小是该时代内所有事件形成的遗憾次数",
            "formal": "tears_of_era(i) = |{(j, k) | (x_j, y_j) ≤ (x_k, y_k), 事件 j 和 k 都在时代 i 内}|"
          },
          {
            "name": "special_limit_A",
            "description": "对于所有时代 i，有 c_{i,1} = 1, c_{i,2} = n",
            "formal": "c_{i,1} = 1, c_{i,2} = n"
          },
          {
            "name": "special_limit_B",
            "description": "任意两个不同时代所代表的矩形，它们要么是包含关系（一个矩形在另一个矩形内，边界允许重合），要么是相离关系（两矩形不包含共同点，边界不允许重合）",
            "formal": "对于任意 i ≠ j，(r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2}) 和 (r_{j,1}, r_{j,2}, c_{j,1}, c_{j,2}) 要么满足 (r_{i,1} ≤ r_{j,1} ≤ r_{j,2} ≤ r_{i,2} 且 c_{i,1} ≤ c_{j,1} ≤ c_{j,2} ≤ c_{i,2})，要么满足 (r_{i,2} < r_{j,1} 或 r_{j,2} < r_{i,1} 或 c_{i,2} < c_{j,1} 或 c_{j,2} < c_{i,1})"
          },
          {
            "name": "special_limit_C",
            "description": "最多有 50 对事件 (i, j) (1 ≤ i < j ≤ n) 不满足 (i, p_i) ≤ (j, p_j)",
            "formal": "|{(i, j) | 1 ≤ i < j ≤ n 且 (i, p_i) ≰ (j, p_j)}| ≤ 50"
          }
        ]
      }
    }
  ],
  "objective": [
    {
      "round": 1,
      "status": "success",
      "result": {
        "type": "count",
        "description": "计算每个时代内包含的所有事件所形成的遗憾次数"
      }
    },
    {
      "round": 2,
      "status": "success",
      "result": {
        "type": "count",
        "description": "计算每个时代内包含的所有事件形成的遗憾次数"
      }
    },
    {
      "round": 3,
      "status": "success",
      "result": {
        "type": "count",
        "description": "计算每个时代内包含的所有事件形成的遗憾次数"
      }
    }
  ],
  "invariant": [
    {
      "round": 1,
      "status": "success",
      "result": {
        "name": "interval_mergeable",
        "description": "区间可合并性，通过前缀和或线段树等数据结构可以高效计算任意区间的遗憾次数",
        "properties": {
          "prefix_sum": true,
          "segment_tree": true
        }
      }
    },
    {
      "round": 2,
      "status": "success",
      "result": {
        "name": "monotonicity",
        "description": "事件的坐标满足单调性，可以利用双指针或滑动窗口来高效计算每个时代的眼泪大小",
        "properties": {
          "left_monotonic": true,
          "right_monotonic": true
        }
      }
    },
    {
      "round": 3,
      "status": "success",
      "result": {
        "name": "interval_mergeable",
        "description": "区间信息可通过子区间合并，适用于前缀和或线段树等数据结构来高效计算时代的眼泪大小",
        "properties": {
          "prefix_sum": true
        }
      }
    }
  ]
}